<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="5805a475-c188-412b-a626-6ab6b6ef2182" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="RCR686" searchProperties="true" timeout="0" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="5a5fc65e-710a-4353-b774-e19e85d48635fileName">NBR</con:setting>
    <con:setting id="0156e8cb-c1d0-4491-a148-78ee3552afc7fileName">RCR658</con:setting>
    <con:setting id="5805a475-c188-412b-a626-6ab6b6ef2182fileName">RCR686</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="groovy" name="Initialise_Properties" id="19eaf284-25ac-41e4-ba29-02145f6e5023">
    <con:settings/>
    <con:config>
      <script>// initialise values
testRunner.testCase.setPropertyValue( 'TotalOfValuesChecked',  '0')
testRunner.testCase.setPropertyValue( 'NumOfIterations',  '0')


//Creates outout file
now=new java.text.SimpleDateFormat("yyyyMMdd'T'HHmmss").format(new Date())

testRunner.testCase.setPropertyValue( 'ResultFile',("N:/Systems_development/RIO/Road MTA-CR-242/Soap UI/Test Results/RCR-686/Results" + now + ".txt"));
FileOutputStream out1 = new FileOutputStream(context.expand( '${#TestCase#ResultFile}' ));
out1.write();
out1.close();

testRunner.testCase.setPropertyValue( 'RenewalFile',("N:/Systems_development/RIO/Road MTA-CR-242/Soap UI/Test Results/RCR-686/Renewal" + now + ".txt"));
FileOutputStream out2 = new FileOutputStream(context.expand( '${#TestCase#RenewalFile}' ));
out2.write();
out2.close();</script>
    </con:config>
  </con:testStep>
  <con:testStep type="datasource" name="686All" id="e2473e76-fb30-4a1c-9af3-8d84079579f0">
    <con:settings>
      <con:setting id="com.eviware.soapui.impl.wsdl.teststeps.datasource.DataSourceContainer@prepared-properties">&lt;xml-fragment/></con:setting>
    </con:settings>
    <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSource type="Excel">
        <con:configuration>
          <file>N:/Systems_development/RIO/Road MTA-CR-242/Soap Pricing/RCR-686/RCR-686_InputSheet.xlsx</file>
          <worksheet>MTA</worksheet>
          <cell>A2</cell>
          <ignoreEmpty>false</ignoreEmpty>
          <evaluateFormulas>false</evaluateFormulas>
        </con:configuration>
      </con:dataSource>
      <con:shared>false</con:shared>
      <con:restartShared>false</con:restartShared>
      <con:property>ID</con:property>
      <con:property>Scenario</con:property>
      <con:property>ExProduct</con:property>
      <con:property>EXBRC</con:property>
      <con:property>ExCover_type</con:property>
      <con:property>EXCar1</con:property>
      <con:property>EXCar2</con:property>
      <con:property>EXCar3</con:property>
      <con:property>EXCar4</con:property>
      <con:property>U17_ASSOCIATE</con:property>
      <con:property>POLICYSTARTDATE</con:property>
      <con:property>POLICYENDDATE</con:property>
      <con:property>MTA Date</con:property>
      <con:property>FlexFactor</con:property>
      <con:property>Payment type</con:property>
      <con:property>COOLINGOFF FLAG_RO</con:property>
      <con:property>COOLINGOFF FLAG_RE</con:property>
      <con:property>COOLINGOFF FLAG_HS</con:property>
      <con:property>COOLINGOFF FLAG_SM</con:property>
      <con:property>COOLINGOFF FLAG_BRC</con:property>
      <con:property>ProrataMore</con:property>
      <con:property>ProrataLess</con:property>
      <con:property>Persistent Offer</con:property>
      <con:property>Renewal Offer</con:property>
      <con:property>RNL AD</con:property>
      <con:property>AGENT_DISCOUNT_TYPE_1</con:property>
      <con:property>AGENT_DISCOUNT_VALUE_1</con:property>
      <con:property>AGENT_DISCOUNT_TYPE_2</con:property>
      <con:property>AGENT_DISCOUNT_VALUE_2</con:property>
      <con:property>NewProduct</con:property>
      <con:property>NewBRC</con:property>
      <con:property>NewCover_type</con:property>
      <con:property>NewCar1</con:property>
      <con:property>NewCar2</con:property>
      <con:property>NewCar3</con:property>
      <con:property>NewCar4</con:property>
      <con:property>MTA Offer</con:property>
      <con:property>MTA AD</con:property>
      <con:property>MTAAGENT_DISCOUNT_TYPE_1</con:property>
      <con:property>MTAAGENT_DISCOUNT_VALUE_1</con:property>
      <con:property>MTAAGENT_DISCOUNT_TYPE_2</con:property>
      <con:property>MTAAGENT_DISCOUNT_VALUE_2</con:property>
      <con:property>MTA System Discount</con:property>
      <con:property>Multiplying Factor</con:property>
      <con:property>PaidPeriod_RO</con:property>
      <con:property>PaidPeriod_RE</con:property>
      <con:property>PaidPeriod_SM</con:property>
      <con:property>PaidPeriod_HS</con:property>
      <con:property>PaidPeriod_BRC</con:property>
      <con:startRow>0</con:startRow>
      <con:endRow/>
      <con:recordsPerIteration>1</con:recordsPerIteration>
      <con:completeLastOperation>false</con:completeLastOperation>
      <con:trimValues>false</con:trimValues>
      <con:entitizeValues>false</con:entitizeValues>
      <con:restartOnRun>true</con:restartOnRun>
      <con:expandProperties>false</con:expandProperties>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="TestRun" id="eb55e69d-26e8-4ede-ac87-8492136fb6f5" disabled="true">
    <con:settings/>
    <con:config>
      <script>def project = testRunner.testCase.testSuite.project;

//testRunner.testCase.setPropertyValue('payment','CMM');

testRunner.runTestStep( project.testSuites['RCR686'].testCases['RCR686'].testSteps['Setup_686_ProductList_XML'] );
testRunner.runTestStep( project.testSuites['RCR686'].testCases['RCR686'].testSteps['Setup_686_Cover_Value'] );
testRunner.runTestStep( project.testSuites['RCR686'].testCases['RCR686'].testSteps['Setup_686_Reprice'] );
testRunner.runTestStep( project.testSuites['RCR686'].testCases['RCR686'].testSteps['Setup_686_AgentDiscount_XML'] );
testRunner.runTestStep( project.testSuites['RCR686'].testCases['RCR686'].testSteps['RenewalE2E'] );
testRunner.runTestStep( project.testSuites['RCR686'].testCases['RCR686'].testSteps['Setup_686_RenewalYr2CurrentPolicyPrice'] );
testRunner.runTestStep( project.testSuites['RCR686'].testCases['RCR686'].testSteps['RenewalE2E YR2'] );
testRunner.runTestStep( project.testSuites['RCR686'].testCases['RCR686'].testSteps['Setup_686_New_ProductList_XML'] );
testRunner.runTestStep( project.testSuites['RCR686'].testCases['RCR686'].testSteps['Setup_686_NewCover_Value'] );
testRunner.runTestStep( project.testSuites['RCR686'].testCases['RCR686'].testSteps['Setup_686_NewAgentDiscount_XML'] );
testRunner.runTestStep( project.testSuites['RCR686'].testCases['RCR686'].testSteps['Setup_686_CurrentPolicyPrice'] );
testRunner.runTestStep( project.testSuites['RCR686'].testCases['RCR686'].testSteps['Setup_686_TransPolicyPrice'] );
testRunner.runTestStep( project.testSuites['RCR686'].testCases['RCR686'].testSteps['686Request'] );</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Setup_686_ProductList_XML" id="5dce9e09-a245-436d-a692-eb305b2f5d26">
    <con:settings/>
    <con:config>
      <script><![CDATA[def ExproductType = context.expand( '${686All#ExProduct}' )
log.info(ExproductType)
String delimiters = "\\,|\\&()";
String[] prodArr = ExproductType.split(delimiters);
StringBuilder strBld = new StringBuilder();

StringBuilder RenewalStr = new StringBuilder();
if(prodArr.length > 0)
{
	for (prod in prodArr)
	{
		strBld.append("<gen:Product>");
		strBld.append("<prod:ProductCode>");
		if(prod.trim().equals("Roadside"))
		{
			if(context.expand( '${686All#ExCover_type}' ) =="V1")
				{
					strBld.append("PRD_UK_0002");
					
				}
				else
				{
					strBld.append("PRD_UK_0001");
					
				}
		}
		if(prod.trim().equals("Home Start"))
		{
			strBld.append("PRD_UK_0003");
			RenewalStr.append ("<gen:Product><prod:ProductCode>PRD_UK_0003</prod:ProductCode><prod:ProductPriceName>HomeStart</prod:ProductPriceName><gen:PriceList><prod:PolicyPrice><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice>")
			RenewalStr.append ("<prod:NetRate>7.07</prod:NetRate><prod:NetRateTax>0.85</prod:NetRateTax><prod:Commission>36.29</prod:Commission><prod:CommissionTax>4.36</prod:CommissionTax><prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount><prod:TaxPercentage>0.12</prod:TaxPercentage><prod:TaxTotal>5.21</prod:TaxTotal><prod:Total>48.57</prod:Total></prod:CorePrice>")
			RenewalStr.append ("<prod:ArrangementFee><prod:Fee>9.96</prod:Fee><prod:FeeTax>0.0</prod:FeeTax><prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount><prod:TaxPercentage>0.12</prod:TaxPercentage><prod:Total>9.96</prod:Total></prod:ArrangementFee>")
			RenewalStr.append ("<prod:AccountingTotals><prod:CoreDiscountsTotal>0.0</prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal>0.0</prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal>0.0</prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal>0.0</prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal>0.0</prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal>0.0</prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal>0.0</prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown>")
			RenewalStr.append ("<prod:TaxType>I</prod:TaxType><prod:TaxDate>2020-02-01T00:00:00</prod:TaxDate><prod:DateInceptedOnPolicy>2020-02-01T00:00:00</prod:DateInceptedOnPolicy><prod:RelativityPriceFactor>0.7151</prod:RelativityPriceFactor><prod:ExtrapolationFactor>1.0</prod:ExtrapolationFactor><prod:ArrangementFeeTotal>9.96</prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal>63.22</prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts>73.18</prod:TotalLessDiscounts><prod:Total>73.18</prod:Total></prod:PolicyPrice></gen:PriceList></gen:Product>")
		}
		if(prod.trim().equals("Relay"))
		{
			strBld.append("PRD_UK_0004");
			RenewalStr.append ("<gen:Product><prod:ProductCode>PRD_UK_0004</prod:ProductCode><prod:ProductPriceName>Relay</prod:ProductPriceName><gen:PriceList><prod:PolicyPrice><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice>")
			RenewalStr.append ("<prod:NetRate>0.0</prod:NetRate><prod:NetRateTax>0.0</prod:NetRateTax><prod:Commission>59.53</prod:Commission><prod:CommissionTax>7.14</prod:CommissionTax><prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount><prod:TaxPercentage>0.12</prod:TaxPercentage><prod:TaxTotal>7.14</prod:TaxTotal><prod:Total>66.67</prod:Total></prod:CorePrice>")
			RenewalStr.append ("<prod:ArrangementFee><prod:Fee>9.96</prod:Fee><prod:FeeTax>0.0</prod:FeeTax><prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount><prod:TaxPercentage>0.12</prod:TaxPercentage><prod:Total>9.96</prod:Total></prod:ArrangementFee>")
			RenewalStr.append ("<prod:AccountingTotals><prod:CoreDiscountsTotal>0.0</prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal>0.0</prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal>0.0</prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal>0.0</prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal>0.0</prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal>0.0</prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal>0.0</prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown>")
			RenewalStr.append ("<prod:TaxType>I</prod:TaxType><prod:TaxDate>2020-02-01T00:00:00</prod:TaxDate><prod:DateInceptedOnPolicy>2020-02-01T00:00:00</prod:DateInceptedOnPolicy><prod:RelativityPriceFactor>1.0</prod:RelativityPriceFactor><prod:ExtrapolationFactor>1.0</prod:ExtrapolationFactor><prod:ArrangementFeeTotal>9.96</prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal>66.67</prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts>76.63</prod:TotalLessDiscounts><prod:Total>76.63</prod:Total></prod:PolicyPrice></gen:PriceList></gen:Product>")
		}
		if(prod.trim().equals("Stay Mobile") ||prod.trim().equals("Staymobile") )
		{
			strBld.append("PRD_UK_0005");
			RenewalStr.append ("<gen:Product><prod:ProductCode>PRD_UK_0005</prod:ProductCode><prod:ProductPriceName>StayMobile</prod:ProductPriceName><gen:PriceList><prod:PolicyPrice><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice>")
			RenewalStr.append ("<prod:NetRate>0.0</prod:NetRate><prod:NetRateTax>0.0</prod:NetRateTax><prod:Commission>56.45</prod:Commission><prod:CommissionTax>6.77</prod:CommissionTax><prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount><prod:TaxPercentage>0.12</prod:TaxPercentage><prod:TaxTotal>6.77</prod:TaxTotal><prod:Total>63.22</prod:Total></prod:CorePrice>")
			RenewalStr.append ("<prod:ArrangementFee><prod:Fee>9.96</prod:Fee><prod:FeeTax>0.0</prod:FeeTax><prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount><prod:TaxPercentage>0.12</prod:TaxPercentage><prod:Total>9.96</prod:Total></prod:ArrangementFee>")
			RenewalStr.append ("<prod:AccountingTotals><prod:CoreDiscountsTotal>0.0</prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal>0.0</prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal>0.0</prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal>0.0</prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal>0.0</prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal>0.0</prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal>0.0</prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown>")
			RenewalStr.append ("<prod:TaxType>I</prod:TaxType><prod:TaxDate>2020-02-01T00:00:00</prod:TaxDate><prod:DateInceptedOnPolicy>2020-02-01T00:00:00</prod:DateInceptedOnPolicy><prod:RelativityPriceFactor>1.0</prod:RelativityPriceFactor><prod:ExtrapolationFactor>1.0</prod:ExtrapolationFactor><prod:ArrangementFeeTotal>9.96</prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal>48.57</prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts>58.53</prod:TotalLessDiscounts><prod:Total>58.53</prod:Total></prod:PolicyPrice></gen:PriceList></gen:Product>")
		}

		if(prod.trim().equals("BRC") ||prod.trim().equals("BRC") )
		{
			strBld.append("PRD_UK_0018");
			
			RenewalStr.append ("<gen:Product><prod:ProductCode>PRD_UK_0018</prod:ProductCode><prod:ProductPriceName>BRC</prod:ProductPriceName><gen:PriceList><prod:PolicyPrice><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice>")
			RenewalStr.append ("<prod:NetRate>0.0</prod:NetRate><prod:NetRateTax>0.0</prod:NetRateTax><prod:Commission>56.45</prod:Commission><prod:CommissionTax>6.77</prod:CommissionTax><prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount><prod:TaxPercentage>0.12</prod:TaxPercentage><prod:TaxTotal>6.77</prod:TaxTotal><prod:Total>63.22</prod:Total></prod:CorePrice>")
			RenewalStr.append ("<prod:ArrangementFee><prod:Fee>9.96</prod:Fee><prod:FeeTax>0.0</prod:FeeTax><prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount><prod:TaxPercentage>0.12</prod:TaxPercentage><prod:Total>9.96</prod:Total></prod:ArrangementFee>")
			RenewalStr.append ("<prod:AccountingTotals><prod:CoreDiscountsTotal>0.0</prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal>0.0</prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal>0.0</prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal>0.0</prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal>0.0</prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal>0.0</prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal>0.0</prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown>")
			RenewalStr.append ("<prod:TaxType>I</prod:TaxType><prod:TaxDate>2020-02-01T00:00:00</prod:TaxDate><prod:DateInceptedOnPolicy>2020-02-01T00:00:00</prod:DateInceptedOnPolicy><prod:RelativityPriceFactor>1.0</prod:RelativityPriceFactor><prod:ExtrapolationFactor>1.0</prod:ExtrapolationFactor><prod:ArrangementFeeTotal>9.96</prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal>48.57</prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts>58.53</prod:TotalLessDiscounts><prod:Total>58.53</prod:Total></prod:PolicyPrice></gen:PriceList></gen:Product>")
		}
		strBld.append("</prod:ProductCode>");
		strBld.append("</gen:Product>");
	}
	
}
if(context.expand('${686All#EXBRC}').equals("Y"))
{
	//strBld.append("<gen:Product><prod:ProductCode>PRD_UK_0018</prod:ProductCode></gen:Product>");
	strBld.append("<gen:VehicleAgeList>")
		if (context.expand( '${686All#ExCar1}' ) != "")
		{
			strBld.append("<gen:VehicleAge>"+context.expand( '${686All#ExCar1}' )+"</gen:VehicleAge>")
		}
		if (context.expand( '${686All#ExCar2}' ) != "")
		{
			strBld.append("<gen:VehicleAge>"+context.expand( '${686All#ExCar2}' )+"</gen:VehicleAge>")
		}
		if (context.expand( '${686All#ExCar3}' ) != "")
		{
			strBld.append("<gen:VehicleAge>"+context.expand( '${686All#ExCar3}' )+"</gen:VehicleAge>")
		}
		if (context.expand( '${686All#ExCar4}' ) != "")
		{
			strBld.append("<gen:VehicleAge>"+context.expand( '${686All#ExCar4}' )+"</gen:VehicleAge>")
		}
           strBld.append("</gen:VehicleAgeList>")
}
taxtype="I";
testRunner.testCase.setPropertyValue( "ProductList_XML",  strBld.toString()) //sends nodes in Request
testRunner.testCase.setPropertyValue( "RenewalPrice",  RenewalStr.toString())
log.info(strBld)
log.info(RenewalStr)]]></script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Setup_686_Cover_Value" id="6a8c43f4-c646-4358-b525-32b529b6dcf4">
    <con:settings/>
    <con:config>
      <script>def cover = context.expand( '${686All#ExCover_type}' )

String coverToUse = "";

if(cover.equals("V1"))
{
	coverToUse = "0";
}
if(cover.equals("P1"))
{
	coverToUse = "1";
}
if(cover.equals("P2"))
{
	coverToUse = "2";
}
if(cover.equals("P3"))
{
	coverToUse = "3";
}
if(cover.equals("P4"))
{
	coverToUse = "4";
}

testRunner.testCase.setPropertyValue( "Cover",  coverToUse)
log.info(coverToUse)</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Setup_686_Reprice" id="ecb35a05-e6b4-4b31-a482-b79896d50968">
    <con:settings/>
    <con:config>
      <script><![CDATA[def offercode = context.expand( '${686All#Renewal Offer}' )
log.info offercode
def repricestring
def offerstring

repricestring = ""

if(offercode=="DR2YPC17" || offercode=="SPDR2YPC17")
{
repricestring = "<gen:RepriceDetails><gen:RepriceAction>MaintainOriginalPrice</gen:RepriceAction><gen:OriginalPrice>100</gen:OriginalPrice><prod:RelatedAdjustmentCode>"+offercode+"</prod:RelatedAdjustmentCode></gen:RepriceDetails>"
log.info repricestring
}
else if (offercode=="DR2YPC25" || offercode=="SPDR2YPC17")
{
repricestring = "<gen:RepriceDetails><gen:RepriceAction>MaintainOriginalPrice</gen:RepriceAction><gen:OriginalPrice>100</gen:OriginalPrice><prod:RelatedAdjustmentCode>"+offercode+"</prod:RelatedAdjustmentCode></gen:RepriceDetails>"
log.info repricestring
}
else if(offercode=="DR2YPC50" || offercode=="SPDR2YPC17")
{
repricestring = "<gen:RepriceDetails><gen:RepriceAction>MaintainOriginalPrice</gen:RepriceAction><gen:OriginalPrice>100</gen:OriginalPrice><prod:RelatedAdjustmentCode>"+offercode+"</prod:RelatedAdjustmentCode></gen:RepriceDetails>"
log.info repricestring
}

testRunner.testCase.setPropertyValue( "Reprice",  repricestring.toString())]]></script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Setup_686_AgentDiscount_XML" id="81c7658f-0dcc-40ee-bd74-01a1a4116f2b">
    <con:settings/>
    <con:config>
      <script><![CDATA[def payment = context.expand( '${686All#Payment type}' )

StringBuilder strBld = new StringBuilder();
StringBuilder strBld2 = new StringBuilder();
def OldAD = context.expand( '${686All#RNL AD}' )

if(OldAD !="")
{
	def x 
		//def AgentDiscountValue
	def d = Integer.parseInt(OldAD); 
	log.info(d)
	if (d != 0)
	{
		strBld.append("<prod:AgentDiscountRequestedList>");
		for( int i=1 ; i<=d; i++  ) 
		{
			if(context.expand('${686All#AGENT_DISCOUNT_VALUE_' + i + '}') == "")
			{
				strBld.append("")
			}
			else
			{
				def Type = context.expand('${686All#AGENT_DISCOUNT_TYPE_' + i + '}')
				
				AgentDiscountValue = context.expand('${686All#AGENT_DISCOUNT_VALUE_' + i + '}')
				log.info AgentDiscountValue
				log.info(AgentDiscountValue + d )
			
				new_code="ABI"+i+"C"
				strBld.append("<prod:AgentDiscountRequested>");
				strBld.append("<prod:AgentDiscountCode>" + new_code + "</prod:AgentDiscountCode>");
				strBld.append("<prod:AgentDiscountType>" + context.expand('${686All#AGENT_DISCOUNT_TYPE_' + i + '}') + "</prod:AgentDiscountType>");
				strBld.append("<prod:AgentDiscountValue>" + AgentDiscountValue + "</prod:AgentDiscountValue>");
				strBld.append("</prod:AgentDiscountRequested>");
				x = i
			}
		}
		strBld.append("</prod:AgentDiscountRequestedList>");  
	}
	
	strBld2.append(x)
	log.info(strBld)
	log.info(strBld2)
	testRunner.testCase.setPropertyValue( "AgentDiscount_XML", strBld.toString())
	testRunner.testCase.setPropertyValue( "AgentDiscountsApplied", strBld2.toString())
}
else
{
	log.info("no discounts")
	testRunner.testCase.setPropertyValue( "AgentDiscount_XML", "")
}]]></script>
    </con:config>
  </con:testStep>
  <con:testStep type="request" id="29730b0f-afa9-4def-9a97-531c07b0723b" name="RenewalE2E">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>SOAPServiceBindingRNL</con:interface>
      <con:operation>GenerateQuote</con:operation>
      <con:request name="RenewalE2E" id="ee2a69d2-b309-443e-a695-e7fc15cd5e91">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://rh0124v:18047/SOAPServiceBinding/BSROS_GenerateQuote_RNL/</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:gen="http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3" xmlns:mes="http://www.theaa.com/CommonServices/Data/Message/MessageHeader.2" xmlns:com="http://www.theaa.com/CommonServices/Data/Common" xmlns:prod="http://www.theaa.com/CommonServices/Data/Product.2" xmlns:mem="http://www.theaa.com/CommonServices/Data/Membership.2" xmlns:veh="http://www.theaa.com/CommonServices/Data/General/Vehicle">
   <soapenv:Header/>
   <soapenv:Body>
      <gen:GenerateQuoteRequest>
         <mes:RequestHeader>
            <mes:TransactionId>RNLQ-1903-666</mes:TransactionId>
            <mes:Version>1.0</mes:Version>
            <mes:RequestDateTime>2020-01-26T00:00:00</mes:RequestDateTime>
            <mes:Source>
               <mes:Domain>SALES</mes:Domain>
               <mes:Channel>SanityTesting</mes:Channel>
               <mes:LineOfBusiness>ROS</mes:LineOfBusiness>
               <mes:Name>Pricing Services</mes:Name>
               <mes:User>PS Testing</mes:User>
            </mes:Source>
         </mes:RequestHeader>
         <gen:IndicativePriceFlag>false</gen:IndicativePriceFlag>
         <gen:CurrentFlexDetails>
            <prod:FlexFactorOnCurrentPolicy>1</prod:FlexFactorOnCurrentPolicy>
         </gen:CurrentFlexDetails>
         <gen:RenewalFlexDetails>
            <prod:FlexFactor>${686All#FlexFactor}</prod:FlexFactor>
            <prod:FlexFactorCalculatedFlag>true</prod:FlexFactorCalculatedFlag>
         </gen:RenewalFlexDetails>
<!--         ${#TestCase#Reprice}-->
         <gen:PaymentType>${686All#Payment type}</gen:PaymentType>
         <gen:ProductList>
            <prod:EffectivePriceDateTime>${686All#POLICYSTARTDATE}T00:00:00</prod:EffectivePriceDateTime>
            <prod:PolicyStartDateTime>${686All#POLICYSTARTDATE}T00:00:00</prod:PolicyStartDateTime>
            <prod:PolicyEndDateTime>${686All#POLICYENDDATE}T00:00:00</prod:PolicyEndDateTime>
            <prod:OfferCodeDetailList>
               <prod:OfferCodeDetail>
                  <prod:OfferCode>${686All#Persistent Offer}</prod:OfferCode>
                  <prod:OfferCodeApplicationLevel>1</prod:OfferCodeApplicationLevel>
                  <prod:IsPersistent>true</prod:IsPersistent>
               </prod:OfferCodeDetail>
               <prod:OfferCodeDetail>
                  <prod:OfferCode>${686All#Renewal Offer}</prod:OfferCode>
                  <prod:OfferCodeApplicationLevel>2</prod:OfferCodeApplicationLevel>
                  <prod:IsPersistent>false</prod:IsPersistent>
               </prod:OfferCodeDetail>
            </prod:OfferCodeDetailList>
            <prod:SourceGroup>15</prod:SourceGroup>
            <prod:SourceCode>W1037</prod:SourceCode>
            <prod:Currency>GBP</prod:Currency>
            <gen:MembershipTenure>1</gen:MembershipTenure>
            ${#TestCase#ProductList_XML}
            <gen:CoveredPersons>${#TestCase#Cover}</gen:CoveredPersons>
            ${#TestCase#AgentDiscount_XML}
         </gen:ProductList>
         <gen:CustomerDetails>
            <gen:Postcode>RG214EA</gen:Postcode>
            <mem:MembershipNumber>6356011512658868</mem:MembershipNumber>
         </gen:CustomerDetails>
         <gen:RenewalRiskData>
            <gen:PartialFreeMembershipFlag>false</gen:PartialFreeMembershipFlag>
            <gen:RecordedPaymentType>RAP</gen:RecordedPaymentType>
            <gen:RecordedPaymentMeans>DD</gen:RecordedPaymentMeans>
            <gen:InScopeFlexFlag>true</gen:InScopeFlexFlag>
            <gen:OptInOfferFlag>true</gen:OptInOfferFlag>
         </gen:RenewalRiskData>
         <gen:CurrentPolicyDetails>
            <prod:PaymentType>RAP</prod:PaymentType>
            <prod:PolicyStartDateTime>2020-07-10T00:00:00</prod:PolicyStartDateTime>
            <prod:PolicyEndDateTime>2021-07-09T00:00:00</prod:PolicyEndDateTime>
            <prod:CoveredPersons>4</prod:CoveredPersons>
            <prod:Currency>GBP</prod:Currency>
            <gen:Product>
               <prod:ProductCode>PRD_UK_0011</prod:ProductCode>
               <prod:ProductPriceName>Roadside</prod:ProductPriceName>
               <gen:PriceList>
                  <prod:PolicyPrice>
                     <prod:PriceElementType/>
                     <prod:PriceBreakdown>
                        <prod:CorePrice>
                           <prod:NetRate>0.0</prod:NetRate>
                           <prod:NetRateTax>0.0</prod:NetRateTax>
                           <prod:Commission>50.5</prod:Commission>
                           <prod:CommissionTax>6.06</prod:CommissionTax>
                           <prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount>
                           <prod:TaxPercentage>0.12</prod:TaxPercentage>
                           <prod:TaxTotal>6.06</prod:TaxTotal>
                           <prod:Total>56.56</prod:Total>
                        </prod:CorePrice>
                        <prod:ArrangementFee>
                           <prod:Fee>24.96</prod:Fee>
                           <prod:FeeTax>0.0</prod:FeeTax>
                           <prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount>
                           <prod:TaxPercentage>0.12</prod:TaxPercentage>
                           <prod:Total>24.96</prod:Total>
                        </prod:ArrangementFee>
                        <prod:AccountingTotals>
                           <prod:CoreDiscountsTotal>0.0</prod:CoreDiscountsTotal>
                           <prod:CoreDiscountsTaxTotal>0.0</prod:CoreDiscountsTaxTotal>
                           <prod:CoreCommissionDiscountsTotal>0.0</prod:CoreCommissionDiscountsTotal>
                           <prod:CoreNetRateDiscountsTotal>0.0</prod:CoreNetRateDiscountsTotal>
                           <prod:ArrangementFeeGrandDiscountsTotal>0.0</prod:ArrangementFeeGrandDiscountsTotal>
                           <prod:ArrangementFeeTaxDiscountsTotal>0.0</prod:ArrangementFeeTaxDiscountsTotal>
                           <prod:ArrangementFeeDiscountsTotal>0.0</prod:ArrangementFeeDiscountsTotal>
                        </prod:AccountingTotals>
                     </prod:PriceBreakdown>
                     <prod:TaxType>I</prod:TaxType>
                     <prod:TaxDate>2020-02-01T00:00:00</prod:TaxDate>
                     <prod:DateInceptedOnPolicy>2020-02-01T00:00:00</prod:DateInceptedOnPolicy>
                     <prod:RelativityPriceFactor>1.0</prod:RelativityPriceFactor>
                     <prod:ExtrapolationFactor>1.0</prod:ExtrapolationFactor>
                     <prod:ArrangementFeeTotal>24.96</prod:ArrangementFeeTotal>
                     <prod:TotalLessArrangementFeeTotal>56.56</prod:TotalLessArrangementFeeTotal>
                     <prod:TotalLessDiscounts>81.52</prod:TotalLessDiscounts>
                     <prod:Total>81.52</prod:Total>
                  </prod:PolicyPrice>
               </gen:PriceList>
            </gen:Product>
            ${#TestCase#RenewalPrice}
         </gen:CurrentPolicyDetails>
      </gen:GenerateQuoteRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Valid HTTP Status Codes" id="402668d8-cb01-48e4-961a-a0158986ebf3" name="Valid HTTP Status Codes" disabled="true">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:assertion type="SOAP Fault Assertion" id="f72160ce-122b-4453-a59e-0977012f98ce" name="Not SOAP Fault" disabled="true"/>
        <con:assertion type="Schema Compliance" id="69cdeab5-b554-4ec1-88cd-e026cc0bec7c" name="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig action="GenerateQuote" mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Setup_686_RenewalYr2CurrentPolicyPrice" id="3e716af4-0646-42bf-b09b-f20cb3efef31">
    <con:settings/>
    <con:config>
      <script><![CDATA[def productType = context.expand( '${686All#ExProduct}' )
def cover = context.expand( '${686All#ExCover_type}' )

String delimiters = "\\,|\\&";
String[] prodArr = productType.split(delimiters);
StringBuilder Strbld = new StringBuilder()

if(prodArr.length > 0)
{	

	for (prod in prodArr)
	{
			
		if(prod.trim().equals("Roadside"))
		{
			product="Roadside"
			Code="RO"
			
			if(cover.equals("V1"))
			{
				Productcode = "PRD_UK_0002"
			}
			else
			{
				Productcode = "PRD_UK_0001"
			}
			strBldS = func_AddProduct(Productcode,product,Code)
			Strbld.append(strBldS)
		}
		
		if(prod.trim().equals("HomeStart")||prod.trim().equals("Home Start"))
		{
			product= "HomeStart"
			Code="HS"
			Productcode = "PRD_UK_0003"
			strBldS = func_AddProduct(Productcode,product,Code)
			Strbld.append(strBldS)
		}
		if(prod.trim().equals("Relay"))
		{
			product= "Relay"
			Code="RE"
			Productcode = "PRD_UK_0004"
			strBldS = func_AddProduct(Productcode,product,Code)
			Strbld.append(strBldS)
		}
		if(prod.trim().equals("StayMobile")||prod.trim().equals("Stay Mobile"))
		{
			product= "StayMobile"
			Code="SM"
			Productcode = "PRD_UK_0005"
			strBldS = func_AddProduct(Productcode,product,Code)
			Strbld.append(strBldS)
		}
		
	}
	if(context.expand( '${686All#EXBRC}' ).equals("Y"))
	{
		product= "BRC"
		Code="BRC"
		Productcode = "PRD_UK_0018"
		strBldS = func_AddProduct(Productcode,product,Code)
		Strbld.append(strBldS)

		if (context.expand('${686All#EXBRC}').equals("Y"))
	{
		//strBld.append("<gen:Product><prod:ProductCode>PRD_UK_0018</prod:ProductCode></gen:Product>");
		Strbld.append("<prod:VehicleAgeList>")
		if (context.expand( '${658All#ExCar1}' ) != "")
		{
			Strbld.append("<prod:VehicleAge>"+context.expand( '${658All#ExCar1}' )+"</prod:VehicleAge>")
		}
		if (context.expand( '${658All#ExCar2}' ) != "")
		{
			Strbld.append("<prod:VehicleAge>"+context.expand( '${658All#ExCar2}' )+"</prod:VehicleAge>")
		}
		if (context.expand( '${658All#ExCar3}' ) != "")
		{
			Strbld.append("<prod:VehicleAge>"+context.expand( '${658All#ExCar3}' )+"</prod:VehicleAge>")
		}
		if (context.expand( '${658All#ExCar4}' ) != "")
		{
			Strbld.append("<prod:VehicleAge>"+context.expand( '${658All#ExCar4}' )+"</prod:VehicleAge>")
		}
           Strbld.append("</prod:VehicleAgeList>")
	}
		
	}
}


log.info(Strbld)
testRunner.testCase.setPropertyValue("RNL_YR2_CurrentPolicyPrice_XML", Strbld.toString())

def func_AddProduct(Productcode,product,Code)
{
	
	log.info(Productcode)
	log.info(product)
	def paymenttype = context.expand( '${686All#Payment type}' )
	log.info(paymenttype)
	StringBuilder strBldN = new StringBuilder()
	//def flag = context.expand( '${658All#NB/RNL}' )
	def flag = "REN"

	
		log.info "Renewal Block"
		strBldN.append("<gen:Product>")
		strBldN.append("<prod:ProductCode>"+Productcode+"</prod:ProductCode>")
		strBldN.append("<prod:ProductPriceName>"+product+"</prod:ProductPriceName>")
		strBldN.append("<gen:PriceList>")
		strBldN.append("<prod:PolicyPrice>")
		strBldN.append("<prod:PriceElementType/>")
		strBldN.append("<prod:PriceBreakdown>")
     	strBldN.append("<prod:CorePrice>")
		strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:NetRate[1]}' )+"</prod:NetRate>")
		strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
		strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:Commission[1]}' )+"</prod:Commission>")
		strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
   		strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
 		strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
 		strBldN.append("<prod:TaxTotal>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:TaxTotal[1]}' )+"</prod:TaxTotal>")
 		strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:Total[1]}' )+"</prod:Total>")
 		strBldN.append("</prod:CorePrice>")
 		
    	 	strBldN.append("<prod:ArrangementFee>")
		strBldN.append("<prod:Fee>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:Fee[1]}' )+"</prod:Fee>")
		strBldN.append("<prod:FeeTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:FeeTax[1]}' )+"</prod:FeeTax>")
 		strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
 		strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
  		strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:Total[1]}' )+"</prod:Total>")
     	strBldN.append("</prod:ArrangementFee>")
       
		def Offernode = context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:Code[1]}' )
		log.info "Offernode-->"+Offernode
		//if((context.expand( '${658All#NB/RNL Offer}' )!= "") && (Offernode!=""))
		def persistentOffer = context.expand( '${686All#Persistent Offer}' )
		if((persistentOffer!= "") && (Offernode!=""))
   	  	{
    			strBldN.append("<prod:OfferCodeDiscountList>")
          	strBldN.append("<prod:OfferCodeDiscount>")
          	strBldN.append("<prod:Code>"+context.expand( '${686All#Persistent Offer}' )+"</prod:Code>")
          	strBldN.append("<prod:IsPersistent>true</prod:IsPersistent>")
          	strBldN.append("<prod:DiscountApplicationApproach>Product</prod:DiscountApplicationApproach>")
			strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:NetRate[1]}' )+"</prod:NetRate>")
          	strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
          	strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:Commission[1]}' )+"</prod:Commission>")
         		strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
          	strBldN.append("<prod:ArrangementFee>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:ArrangementFee[1]}' )+"</prod:ArrangementFee>")
          	strBldN.append("<prod:ArrangementFeeTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:ArrangementFeeTax[1]}' )+"</prod:ArrangementFeeTax>")
          	strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
         	 	strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
          	strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:Total[1]}' )+"</prod:Total>")
          	strBldN.append("</prod:OfferCodeDiscount>")
          	
          	persistentOffer=""

          	def RenewalOffernode = context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Renewal Offer}' )+'"]/tns6:Code[1]}' )
		log.info "RenewalOffernode-->"+RenewalOffernode
		
		def RenewalOffer = context.expand( '${686All#Renewal Offer}' )
		if((RenewalOffer!= "") && (RenewalOffernode!=""))
   	  	{
    			
          	strBldN.append("<prod:OfferCodeDiscount>")
          	strBldN.append("<prod:Code>"+context.expand( '${686All#Renewal Offer}' )+"</prod:Code>")
          	strBldN.append("<prod:IsPersistent>false</prod:IsPersistent>")
          	strBldN.append("<prod:DiscountApplicationApproach>Product</prod:DiscountApplicationApproach>")
			strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:NetRate[1]}' )+"</prod:NetRate>")
          	strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
          	strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:Commission[1]}' )+"</prod:Commission>")
         		strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
          	strBldN.append("<prod:ArrangementFee>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:ArrangementFee[1]}' )+"</prod:ArrangementFee>")
          	strBldN.append("<prod:ArrangementFeeTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:ArrangementFeeTax[1]}' )+"</prod:ArrangementFeeTax>")
          	strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
         	 	strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
          	strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:Total[1]}' )+"</prod:Total>")
          	strBldN.append("</prod:OfferCodeDiscount>")
          	
		}
		strBldN.append("</prod:OfferCodeDiscountList>")
		}
		else
		{
		
		def RenewalOffernode = context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Renewal Offer}' )+'"]/tns6:Code[1]}' )
		log.info "RenewalOffernode-->"+RenewalOffernode
		
		def RenewalOffer = context.expand( '${686All#Renewal Offer}' )
		if((RenewalOffer!= "") && (RenewalOffernode!=""))
   	  	{
    			strBldN.append("<prod:OfferCodeDiscountList>")
          	strBldN.append("<prod:OfferCodeDiscount>")
          	strBldN.append("<prod:Code>"+context.expand( '${686All#Renewal Offer}' )+"</prod:Code>")
          	strBldN.append("<prod:DiscountApplicationApproach>Product</prod:DiscountApplicationApproach>")
			strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:NetRate[1]}' )+"</prod:NetRate>")
          	strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
          	strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:Commission[1]}' )+"</prod:Commission>")
         		strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
          	strBldN.append("<prod:ArrangementFee>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:ArrangementFee[1]}' )+"</prod:ArrangementFee>")
          	strBldN.append("<prod:ArrangementFeeTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:ArrangementFeeTax[1]}' )+"</prod:ArrangementFeeTax>")
          	strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
         	 	strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
          	strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:Total[1]}' )+"</prod:Total>")
          	strBldN.append("</prod:OfferCodeDiscount>")
          	strBldN.append("</prod:OfferCodeDiscountList>")
		}
		}
		if (context.expand( '${686All#RNL AD}')=="")
		{
			log.info "No AD"
		}
		
		else
		{
		int AD_Count = Integer.parseInt(context.expand( '${686All#RNL AD}' ))
		if(AD_Count !="") 
		{
			def ADNode = context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]}' )
	 	
	 		if (ADNode!="")
			{
				strBldN.append("<prod:AgentDiscountList>")
				for (int i=1; i<=AD_Count; i++)
				{
					strBldN.append("<prod:AgentDiscount>")
					strBldN.append("<prod:Code>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:Code[1]}' )+"</prod:Code>")
               		strBldN.append("<prod:DiscountApplicationApproach>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:DiscountApplicationApproach[1]}' )+"</prod:DiscountApplicationApproach>")
              			 strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:NetRate[1]}' )+"</prod:NetRate>")
              			 strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
              	 		strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:Commission[1]}' )+"</prod:Commission>")
               		strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
               		strBldN.append("<prod:ArrangementFee>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:ArrangementFee[1]}' )+"</prod:ArrangementFee>")
               		strBldN.append("<prod:ArrangementFeeTax>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:ArrangementFeeTax[1]}' )+"</prod:ArrangementFeeTax>")
              		 	strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
               		strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
               		strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:Total[1]}' )+"</prod:Total>")
               		strBldN.append("</prod:AgentDiscount>")
              	 	}
				strBldN.append("</prod:AgentDiscountList>")
			}
		}}
		strBldN.append("<prod:AccountingTotals>")
		strBldN.append("<prod:CoreDiscountsTotal>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreDiscountsTotal[1]}' )+"</prod:CoreDiscountsTotal>")
		strBldN.append("<prod:CoreDiscountsTaxTotal>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreDiscountsTaxTotal[1]}' )+"</prod:CoreDiscountsTaxTotal>")
		strBldN.append("<prod:CoreCommissionDiscountsTotal>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreCommissionDiscountsTotal[1]}' )+"</prod:CoreCommissionDiscountsTotal>")
		strBldN.append("<prod:CoreNetRateDiscountsTotal>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreNetRateDiscountsTotal[1]}' )+"</prod:CoreNetRateDiscountsTotal>")
		strBldN.append("<prod:ArrangementFeeGrandDiscountsTotal>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:ArrangementFeeGrandDiscountsTotal[1]}' )+"</prod:ArrangementFeeGrandDiscountsTotal>")
		strBldN.append("<prod:ArrangementFeeTaxDiscountsTotal>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:ArrangementFeeTaxDiscountsTotal[1]}' )+"</prod:ArrangementFeeTaxDiscountsTotal>")
		strBldN.append("<prod:ArrangementFeeDiscountsTotal>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:ArrangementFeeDiscountsTotal[1]}' )+"</prod:ArrangementFeeDiscountsTotal>")
		strBldN.append("</prod:AccountingTotals>")
		strBldN.append("</prod:PriceBreakdown>")

		strBldN.append("<prod:TaxType>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TaxType[1]}' )+"</prod:TaxType>")
		strBldN.append("<prod:TaxDate>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TaxDate[1]}' )+"</prod:TaxDate>")
		strBldN.append("<prod:DateInceptedOnPolicy>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:DateInceptedOnPolicy[1]}' )+"</prod:DateInceptedOnPolicy>")
    		strBldN.append("<prod:RelativityPriceFactor>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:RelativityPriceFactor[1]}' )+"</prod:RelativityPriceFactor>")
     	strBldN.append("<prod:ExtrapolationFactor>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:ExtrapolationFactor[1]}' )+"</prod:ExtrapolationFactor>")
      	strBldN.append("<prod:ArrangementFeeTotal>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:ArrangementFeeTotal[1]}' )+"</prod:ArrangementFeeTotal>")
  		strBldN.append("<prod:TotalLessArrangementFeeTotal>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TotalLessArrangementFeeTotal[1]}' )+"</prod:TotalLessArrangementFeeTotal>")
     	strBldN.append("<prod:TotalLessDiscounts>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TotalLessDiscounts[1]}' )+"</prod:TotalLessDiscounts>")
     	strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:Total[1]}' )+"</prod:Total>")
		strBldN.append("</prod:PolicyPrice>")
		strBldN.append("</gen:PriceList>")
	
		strBldN.append("</gen:Product>")
	return (strBldN)

}]]></script>
    </con:config>
  </con:testStep>
  <con:testStep type="request" id="678218b2-4512-40a7-a2d7-5d0b1701f1d3" name="RenewalE2E YR2">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>SOAPServiceBindingRNL</con:interface>
      <con:operation>GenerateQuote</con:operation>
      <con:request name="RenewalE2E YR2" id="ee2a69d2-b309-443e-a695-e7fc15cd5e91">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://rh0124v:18047/SOAPServiceBinding/BSROS_GenerateQuote_RNL/</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:gen="http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3" xmlns:mes="http://www.theaa.com/CommonServices/Data/Message/MessageHeader.2" xmlns:com="http://www.theaa.com/CommonServices/Data/Common" xmlns:prod="http://www.theaa.com/CommonServices/Data/Product.2" xmlns:mem="http://www.theaa.com/CommonServices/Data/Membership.2" xmlns:veh="http://www.theaa.com/CommonServices/Data/General/Vehicle">
   <soapenv:Header/>
   <soapenv:Body>
      <gen:GenerateQuoteRequest>
         <mes:RequestHeader>
            <mes:TransactionId>RNLQ-1903-666</mes:TransactionId>
            <mes:Version>1.0</mes:Version>
            <mes:RequestDateTime>2020-01-26T00:00:00</mes:RequestDateTime>
            <mes:Source>
               <mes:Domain>SALES</mes:Domain>
               <mes:Channel>SanityTesting</mes:Channel>
               <mes:LineOfBusiness>ROS</mes:LineOfBusiness>
               <mes:Name>Pricing Services</mes:Name>
               <mes:User>PS Testing</mes:User>
            </mes:Source>
         </mes:RequestHeader>
         <gen:IndicativePriceFlag>false</gen:IndicativePriceFlag>
         <gen:CurrentFlexDetails>
            <prod:FlexFactorOnCurrentPolicy>1</prod:FlexFactorOnCurrentPolicy>
         </gen:CurrentFlexDetails>
         <gen:RenewalFlexDetails>
            <prod:FlexFactor>${686All#FlexFactor}</prod:FlexFactor>
            <prod:FlexFactorCalculatedFlag>true</prod:FlexFactorCalculatedFlag>
         </gen:RenewalFlexDetails>
${#TestCase#Reprice}
         <gen:PaymentType>${686All#Payment type}</gen:PaymentType>
         <gen:ProductList>
            <prod:EffectivePriceDateTime>${686All#POLICYSTARTDATE}T00:00:00</prod:EffectivePriceDateTime>
            <prod:PolicyStartDateTime>${686All#POLICYSTARTDATE}T00:00:00</prod:PolicyStartDateTime>
            <prod:PolicyEndDateTime>${686All#POLICYENDDATE}T00:00:00</prod:PolicyEndDateTime>
            <prod:OfferCodeDetailList>
               <prod:OfferCodeDetail>
                  <prod:OfferCode>${686All#Persistent Offer}</prod:OfferCode>
                  <prod:OfferCodeApplicationLevel>1</prod:OfferCodeApplicationLevel>
                  <prod:IsPersistent>true</prod:IsPersistent>
               </prod:OfferCodeDetail>
          
            </prod:OfferCodeDetailList>
            <prod:SourceGroup>15</prod:SourceGroup>
            <prod:SourceCode>W1037</prod:SourceCode>
            <prod:Currency>GBP</prod:Currency>
            <gen:MembershipTenure>1</gen:MembershipTenure>
            ${#TestCase#ProductList_XML}
            <gen:CoveredPersons>${#TestCase#Cover}</gen:CoveredPersons>
            ${#TestCase#AgentDiscount_XML}
         </gen:ProductList>
         <gen:CustomerDetails>
            <gen:Postcode>RG214EA</gen:Postcode>
            <mem:MembershipNumber>6356011512658868</mem:MembershipNumber>
         </gen:CustomerDetails>
         <gen:RenewalRiskData>
            <gen:PartialFreeMembershipFlag>false</gen:PartialFreeMembershipFlag>
            <gen:RecordedPaymentType>RAP</gen:RecordedPaymentType>
            <gen:RecordedPaymentMeans>DD</gen:RecordedPaymentMeans>
            <gen:InScopeFlexFlag>true</gen:InScopeFlexFlag>
            <gen:OptInOfferFlag>true</gen:OptInOfferFlag>
         </gen:RenewalRiskData>
         <gen:CurrentPolicyDetails>
         <prod:PaymentType>RAP</prod:PaymentType>
            <prod:PolicyStartDateTime>2020-07-10T00:00:00</prod:PolicyStartDateTime>
            <prod:PolicyEndDateTime>2021-07-09T00:00:00</prod:PolicyEndDateTime>
            <prod:CoveredPersons>4</prod:CoveredPersons>
            <prod:Currency>GBP</prod:Currency>
            ${#TestCase#RNL_YR2_CurrentPolicyPrice_XML}
         </gen:CurrentPolicyDetails>
      </gen:GenerateQuoteRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion type="Valid HTTP Status Codes" id="402668d8-cb01-48e4-961a-a0158986ebf3" name="Valid HTTP Status Codes" disabled="true">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:assertion type="SOAP Fault Assertion" id="f72160ce-122b-4453-a59e-0977012f98ce" name="Not SOAP Fault" disabled="true"/>
        <con:assertion type="Schema Compliance" id="69cdeab5-b554-4ec1-88cd-e026cc0bec7c" name="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:wsaConfig action="GenerateQuote" mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="RenewalTestResults" id="952a9653-81d0-4a01-b066-478c15945cc8">
    <con:settings/>
    <con:config>
      <script>def productType = context.expand( '${686All#ExProduct}' )
def cover = context.expand( '${686All#ExCover_type}' )

String delimiters = "\\,|\\&amp;";
String[] prodArr = productType.split(delimiters);
StringBuilder Strbld = new StringBuilder()
def payment = context.expand('${686All#Payment type}')
def id = context.expand( '${686#ID}' )
if(prodArr.length > 0)
{	

	for (prod in prodArr)
	{
			
		if(prod.trim().equals("Roadside"))
		{
			product="Roadside"
			Code="RO"
			
			if(cover.equals("V1"))
			{
				Productcode = "PRD_UK_0002"
			}
			else
			{
				Productcode = "PRD_UK_0001"
			}
			func_Check(productType,product,"RO",payment,id)
		}
		
		if(prod.trim().equals("HomeStart")||prod.trim().equals("Home Start"))
		{
			product= "HomeStart"
			func_Check(productType,product,"HS",payment,id)
		}
		if(prod.trim().equals("Relay"))
		{
			product= "Relay"
			func_Check(productType,product,"RE",payment,id)
		}
		if(prod.trim().equals("StayMobile")||prod.trim().equals("Stay Mobile"))
		{
			product= "StayMobile"
			func_Check(productType,product,"SM",payment,id)
			
		}
		
	}
	if(context.expand( '${686All#EXBRC}' ).equals("Y"))
	{
		product= "BRC"
		func_Check(productType,product,"BRC",payment,id)
		
	}
}


def func_Check(productType,product,name,payment,id)
{
	log.info product
	log.info id
	//Transaction price
	
	def Flex = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:RenewalFlexDetails[1]/tns6:FlexFactor[1]}' )
	def RiskIndicator = context.expand( '${RenewalE2E YR2#Response#declare namespace tns=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; //tns:GenerateQuoteResponse[1]/tns:CommunityOrRiskIndicator[1]}' )


	def CoreNet = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:NetRate[1]}' )
	def CoreNetTax = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:NetRateTax[1]}' )
	def CoreComm = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:Commission[1]}' )
	def CoreCommTax = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:CommissionTax[1]}' )
	def TaxTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:TaxTotal[1]}' )
	def CoreTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:Total[1]}' )
	def AAF = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:Fee[1]}' )
	def AAFTax = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:FeeTax[1]}' )
	def AAFTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:Total[1]}' )

	func_write(payment,"Flex","Flexfactor",Flex) 	
	func_write(payment,"Flex","RiskIndicator",RiskIndicator)	
	func_write(payment,"CORE,Net",product,CoreNet)
	func_write(payment,"CORE,NetTax",product,CoreNetTax)
	func_write(payment,"CORE,Commission",product,CoreComm)
	func_write(payment,"CORE,CommissionTax",product,CoreCommTax)
	func_write(payment,"CORE,TaxTotal",product,TaxTotal)
	func_write(payment,"CORE,Total",product,CoreTotal)
	func_write(payment,"AAF,AAF",product,AAF)
	func_write(payment,"AAF,AAFTax",product,AAFTax)
	func_write(payment,"AAF,Total",product,AAFTotal)
	
	def response =context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName="' + product + '"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[1]/tns6:NetRate[1]}' )
	
	log.info("response" + response)
 	if( response.equals(''))
 	{
 	
 	}
 	else
 	{
	
		Float R_ADNet=Float.parseFloat(context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName="' + product + '"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[1]/tns6:NetRate[1]}'))
		
		Float R_ADNetTax=Float.parseFloat(context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName="' + product + '"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[1]/tns6:NetRateTax[1]}'))
		Float R_ADComm=Float.parseFloat(context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName="' + product + '"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[1]/tns6:Commission[1]}'))
		Float R_ADCommTax=Float.parseFloat(context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName="' + product + '"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[1]/tns6:CommissionTax[1]}'))
		Float R_ADAAF=Float.parseFloat(context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName="' + product + '"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[1]/tns6:ArrangementFee[1]}'))
		Float R_ADAAFTax=Float.parseFloat(context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName="' + product + '"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[1]/tns6:ArrangementFeeTax[1]}'))
		Float R_ADIFD=Float.parseFloat(context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName="' + product + '"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[1]/tns6:InternallyFundedDiscount[1]}'))
		Float R_ADTaxPercentage=Float.parseFloat(context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName="' + product + '"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[1]/tns6:TaxPercentage[1]}'))
		Float R_ADTotal=Float.parseFloat(context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName="' + product + '"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[1]/tns6:Total[1]}'))
		
			func_write(payment,"SysDisc,Net",product,R_ADNet)
			func_write(payment,"SysDisc,NetTax",product,R_ADNetTax)
			func_write(payment,"SysDisc,Commission",product,R_ADComm)
			func_write(payment,"SysDisc,CommissionTax",product,R_ADCommTax)
			func_write(payment,"SysDisc,AAF",product,R_ADAAF)
			func_write(payment,"SysDisc,AAFTax",product,R_ADAAFTax)
			func_write(payment,"SysDisc,IFD",product, R_ADIFD)
			func_write(payment,"SysDisc,Tax%",product, R_ADTaxPercentage)
			func_write(payment,"SysDisc,Total",product,R_ADTotal)	
 	}
	def CoreDiscTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreDiscountsTotal[1]}' )
	def CoreDiscTaxTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreDiscountsTaxTotal[1]}' )
	def CoreCommDiscTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreCommissionDiscountsTotal[1]}' )
	def CoreNetDiscTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreNetRateDiscountsTotal[1]}' )
	def AAFGrandDiscTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:ArrangementFeeGrandDiscountsTotal[1]}' )
	def AAFTaxDiscTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:ArrangementFeeTaxDiscountsTotal[1]}' )
	def AAFDiscTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:ArrangementFeeDiscountsTotal[1]}' )
	def ProdRel = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:RelativityPriceFactor[1]}' )
	def Extrapolation = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:ExtrapolationFactor[1]}' )
	def ProdAAFTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:ArrangementFeeTotal[1]}' )
	def ProdTotalLessAAF = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TotalLessArrangementFeeTotal[1]}' )
	def ProdTotalLessDisc = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TotalLessDiscounts[1]}' )
	def ProdTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:Total[1]}' )

	

	
	
	func_write(payment,"AccountingTotals,CoreDiscTotal",product,CoreDiscTotal)
	func_write(payment,"AccountingTotals,CoreDiscTaxTotal",product,CoreDiscTaxTotal)
	func_write(payment,"AccountingTotals,CoreCommDiscTotal",product,CoreCommDiscTotal)
	func_write(payment,"AccountingTotals,CoreNetDiscTotal",product,CoreNetDiscTotal)
	func_write(payment,"AccountingTotals,AAFGrandDiscTotal",product,AAFGrandDiscTotal)
	func_write(payment,"AccountingTotals,AAFTaxDiscTotal",product,AAFTaxDiscTotal)
	func_write(payment,"AccountingTotals,AAFDiscTotal",product,AAFDiscTotal)
	func_write(payment,"RelFactor",product,ProdRel)
	func_write(payment,"Extrapolation",product,Extrapolation)
	func_write(payment,"AAFTotal",product,ProdAAFTotal)
	func_write(payment,"TotalLessAAFTotal",product,ProdTotalLessAAF)
	func_write(payment,"TotalLessDisc",product,ProdTotalLessDisc)
	func_write(payment,"ProductTotal",product,ProdTotal)


	def AD_CHECK1 = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[1]/tns6:Code[1]}' )

	if (AD_CHECK1!="")
	{
def AD_Net = 			context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[1]/tns6:NetRate[1]}' )
def AD_NetTax = 		context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[1]/tns6:NetRateTax[1]}' )
def AD_Commission = 	context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[1]/tns6:Commission[1]}' )
def AD_CommissionTax = 	context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[1]/tns6:CommissionTax[1]}' )
def AD_AAF = 			context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[1]/tns6:ArrangementFee[1]}' )
def AD_AAFTax = 		context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[1]/tns6:ArrangementFeeTax[1]}' )
def AD_IFD = 			context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[1]/tns6:InternallyFundedDiscount[1]}' )
def AD_Total = 		context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[1]/tns6:Total[1]}' )

			func_write(payment,"AgentDiscount,Net",product,AD_Net)
			func_write(payment,"AgentDiscount,NetTax",product,AD_NetTax)
			func_write(payment,"AgentDiscount,Commission",product,AD_Commission)
			func_write(payment,"AgentDiscount,CommissionTax",product,AD_CommissionTax)
			func_write(payment,"AgentDiscount,AAF",product,AD_AAF)
			func_write(payment,"AgentDiscount,AAFTax",product,AD_AAFTax)
			func_write(payment,"AgentDiscount,IFD",product,AD_IFD)
			func_write(payment,"AgentDiscount,Total",product,AD_Total)
	}

def RENOFFER = context.expand( '${686All#Renewal Offer}' )

def RENOFFER_CHECK = 	 context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RENOFFER+'"]/tns6:Code[1]}' )

if (RENOFFER!="" &amp;&amp; RENOFFER==RENOFFER_CHECK)
{
def REN_Net = 			context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RENOFFER+'"]/tns6:NetRate[1]}' )
def REN_NetTax =		context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RENOFFER+'"]/tns6:NetRateTax[1]}' )
def REN_Commission = 	context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RENOFFER+'"]/tns6:Commission[1]}' )
def REN_CommissionTax = 	context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RENOFFER+'"]/tns6:CommissionTax[1]}' )
def REN_AAF = 			context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RENOFFER+'"]/tns6:ArrangementFee[1]}' )
def REN_AAFTax = 		context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RENOFFER+'"]/tns6:ArrangementFeeTax[1]}' )
def REN_IFD = 			context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RENOFFER+'"]/tns6:InternallyFundedDiscount[1]}' )

def REN_Total = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RENOFFER+'"]/tns6:Total[1]}' )

			func_write(payment,"RenewalOffer,Net",product,REN_Net)
			func_write(payment,"RenewalOffer,NetTax",product,REN_NetTax)
			func_write(payment,"RenewalOffer,Commission",product,REN_Commission)
			func_write(payment,"RenewalOffer,CommissionTax",product,REN_CommissionTax)
			func_write(payment,"RenewalOffer,AAF",product,REN_AAF)
			func_write(payment,"RenewalOffer,AAFTax",product,REN_AAFTax)
			func_write(payment,"RenewalOffer,IFD",product,REN_IFD)
			func_write(payment,"RenewalOffer,Total",product,REN_Total)
			
}


def AD_CHECK2 = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[1]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[2]/tns6:Code[1]}' )
	

	if (AD_CHECK2!="")
	{
def AD_Net2 = 			context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[2]/tns6:NetRate[1]}' )
def AD_NetTax2 = 		context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[2]/tns6:NetRateTax[1]}' )
def AD_Commission2 = 	context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[2]/tns6:Commission[1]}' )
def AD_CommissionTax2 = 	context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[2]/tns6:CommissionTax[1]}' )
def AD_AAF2 = 			context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[2]/tns6:ArrangementFee[1]}' )
def AD_AAFTax2 = 		context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[2]/tns6:ArrangementFeeTax[1]}' )
def AD_IFD2 = 			context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[2]/tns6:InternallyFundedDiscount[1]}' )
def AD_Total2 = 		context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount[2]/tns6:Total[1]}' )

			func_write(payment,"AgentDiscount2,Net",product,AD_Net2)
			func_write(payment,"AgentDiscount2,NetTax",product,AD_NetTax2)
			func_write(payment,"AgentDiscount2,Commission",product,AD_Commission2)
			func_write(payment,"AgentDiscount2,CommissionTax",product,AD_CommissionTax2)
			func_write(payment,"AgentDiscount2,AAF",product,AD_AAF2)
			func_write(payment,"AgentDiscount2,AAFTax",product,AD_AAFTax2)
			func_write(payment,"AgentDiscount2,IFD",product,AD_IFD2)
			func_write(payment,"AgentDiscount2,Total",product,AD_Total2)
	}
	


	

	//Transaction Offer validation
	def OFFER = ""
	def OLDOFFER = context.expand( '${686All#Persistent Offer}' )
	def OfferNode = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+OFFER+'"]/tns6:Code[1]}' )
	def Offernet3,OffernetTax3,Offercomm3,OffercommTax3,OfferAAF3,OfferAAFTax3,OfferIFD3,OfferTotal3
	
	if (OLDOFFER !="" &amp;&amp; OFFER != OLDOFFER) // if old offer needs to be clawed back
	{
		def OldOfferNode = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+OLDOFFER+'"]/tns6:Code[1]}' )
		if (OldOfferNode !="")
		{
			Offernet3 = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+OLDOFFER+'"]/tns6:NetRate[1]}' )
			OffernetTax3 = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+OLDOFFER+'"]/tns6:NetRateTax[1]}' )
			Offercomm3 = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+OLDOFFER+'"]/tns6:Commission[1]}' )
			OffercommTax3 = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+OLDOFFER+'"]/tns6:CommissionTax[1]}' )
			OfferAAF3 = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+OLDOFFER+'"]/tns6:ArrangementFee[1]}' )
			OfferAAFTax3 = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+OLDOFFER+'"]/tns6:ArrangementFeeTax[1]}' )
			OfferIFD3 = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+OLDOFFER+'"]/tns6:InternallyFundedDiscount[1]}' )
			OfferTotal3 = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductPriceName ="'+product+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+OLDOFFER+'"]/tns6:Total[1]}' )

			func_write(payment,"Offer,Net",product,Offernet3)
			func_write(payment,"Offer,NetTax",product,OffernetTax3)
			func_write(payment,"Offer,Commission",product,Offercomm3)
			func_write(payment,"Offer,CommissionTax",product,OffercommTax3)
			func_write(payment,"Offer,AAF",product,OfferAAF3)
			func_write(payment,"Offer,AAFTax",product,OfferAAFTax3)
			func_write(payment,"Offer,IFD",product,OfferIFD3)
			func_write(payment,"Offer,Total",product,OfferTotal3)
		}
	}

//Transaction Price Breakdown
def GrandTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:TotalPriceBreakdown[1]/tns6:Total[1]}' )
def GrandTotalExcDisc = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:TotalPriceBreakdown[1]/tns6:TotalExcludingDiscounts[1]}' )
def DiscTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:TotalPriceBreakdown[1]/tns6:DiscountTotal[1]}' )
def BaseCoverTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:TotalPriceBreakdown[1]/tns6:BaseCoverTotal[1]}' )
def BaseCoverTotalLessDisc = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:TotalPriceBreakdown[1]/tns6:BaseCoverTotalLessDiscounts[1]}' )
def BaseCoverAAFTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:TotalPriceBreakdown[1]/tns6:BaseCoverArrangementFeeTotal[1]}' )
def TotalAAF = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:TotalPriceBreakdown[1]/tns6:TotalArrangementFee[1]}' )
def FeeTotal = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:TotalPriceBreakdown[1]/tns6:SurchargeFeeTotal[1]}' )
def TotalLessTotalAAFAddons = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:TotalPriceBreakdown[1]/tns6:TotalLessTotalAAFAndTotalAddons[1]}' )
def TotalLessFees = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:TotalPriceBreakdown[1]/tns6:TotalLessSurchargeFees[1]}' )
def TotalLessAAF = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:TotalPriceBreakdown[1]/tns6:TotalLessArrangementFees[1]}' )
def TotalIPT = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:TotalPriceBreakdown[1]/tns6:TotalIPT[1]}' )
def TotalVAT = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:TotalPriceBreakdown[1]/tns6:TotalVAT[1]}' )


	func_write(payment,"TotalPriceBreakdown,CombinedTotal","",GrandTotal)
	func_write(payment,"TotalPriceBreakdown,TotalLessDisc","",GrandTotalExcDisc)
	func_write(payment,"TotalPriceBreakdown,DiscountsTotal","",DiscTotal)
	func_write(payment,"TotalPriceBreakdown,BaseCoverTotal","",BaseCoverTotal)
	func_write(payment,"TotalPriceBreakdown,BaseCoverLessDisc","",BaseCoverTotalLessDisc)
	func_write(payment,"TotalPriceBreakdown,BaseCoverAAFTotal","",BaseCoverAAFTotal)
	func_write(payment,"TotalPriceBreakdown,TotalAAF","",TotalAAF)
	func_write(payment,"TotalPriceBreakdown,TotalFee","",FeeTotal)
	func_write(payment,"TotalPriceBreakdown,TotalLessAAFLessAddons","",TotalLessTotalAAFAddons)
	func_write(payment,"TotalPriceBreakdown,TotalLessFee","",TotalLessFees)
	func_write(payment,"TotalPriceBreakdown,TotalLessAAF","",TotalLessAAF)
	func_write(payment,"TotalPriceBreakdown,TotalVAT","",TotalVAT)
	func_write(payment,"TotalPriceBreakdown,TotalIPT","",TotalIPT)
}



def func_write (payment,element,name,RadarValue)
{
	int totalOfValuesChecked = Integer.parseInt(context.expand( '${#TestCase#TotalOfValuesChecked}' ))
	def prodType = context.expand( '${686All#ExProduct}' )

	if (context.expand('${686All#EXBRC}') == "Y")
	{
		ExCar1 = context.expand( '${686All#ExCar1}' )
		ExCar2 = context.expand( '${686All#ExCar2}' )
		ExCar3 = context.expand( '${686All#ExCar3}' )
		ExCar4 = context.expand( '${686All#ExCar4}' )
		if (ExCar4 != "")
		{
			product_type = prodType + "(" + "Car1:" + ExCar1 + ",Car2:" + ExCar2 + ",Car3:" + ExCar3 + ",Car4:" + ExCar4 + ")"
		}
		else if (ExCar3 != "")
		{
			product_type = prodType + "(" + "Car1:" + ExCar1 + ",Car2:" + ExCar2 + ",Car3:" + ExCar3 + ")"
		}
		else if (ExCar2 != "")
		{
			product_type = prodType + "("  + "Car1:" + ExCar1 + ",Car2:" + ExCar2 + ")"
		}
		else
		{
			product_type = prodType + "(" + "Car1:" + ExCar1 + ")"
		}
	}
	else
	{
		product_type = context.expand( '${686All#ExProduct}' )
	}

	
	log.info Pass=(context.expand('${686All#ID}') + "|" + context.expand( '${686All#Renewal Offer}' ) + "|"  + payment + "|" + product_type + "|" + context.expand( '${686All#ExCover_type}' ) + "|" + name + "|" + element + "| " + RadarValue )

	BufferedWriter bw = new BufferedWriter (new FileWriter (context.expand('${#TestCase#RenewalFile}'), true));
	bw.write (Pass);
	bw.newLine();
	bw.flush();
	bw.close();
	totalOfValuesChecked++
	testRunner.testCase.setPropertyValue( 'totalOfValuesChecked',  new Integer(totalOfValuesChecked).toString())
}</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Xml extractor" id="e971521f-eae7-43a5-8d15-fe8cd0f277e1" disabled="true">
    <con:settings/>
    <con:config>
      <script>now=new java.text.SimpleDateFormat("yyyyMMdd'T'HHmmss").format(new Date())
//Save response

def directory = "N:/Systems_development/RIO/Road MTA-CR-242/Soap UI/Test Results/RCR-686/XML"
def scenarioNo = context.expand( '${686All#ID}' )
def requestFile = new File(directory, "${scenarioNo}_requestRenewal"+ now +".xml")
requestFile.append( context.expand('${RenewalE2E#Request}') )
//def responseFile = new File(directory, "${scenarioNo}_response"+ now +".xml")
//responseFile.append( context.expand('${686Request#Response}') )</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Setup_686_New_ProductList_XML" id="98a36c5c-3bd4-4ffd-94e6-7fbd89a9ac4e">
    <con:settings/>
    <con:config>
      <script><![CDATA[def newProduct = context.expand( '${686All#NewProduct}' )

String delimiters = "\\,|\\&";
String[] prodArr = newProduct.split(delimiters);
StringBuilder strBld = new StringBuilder();

if(prodArr.length > 0)
{
	for (prod in prodArr)
	{
		strBld.append("<gen:Product>");
	
		if(prod.trim().equals("Roadside"))
		{
				if (context.expand( '${686All#NewCover_type}' ) == 'V1')
				{
					strBld.append("<prod:ProductCode>PRD_UK_0012</prod:ProductCode>");
				}
				else
				{
					strBld.append("<prod:ProductCode>PRD_UK_0011</prod:ProductCode>");
				}
		}
		if(prod.trim().equals("Home Start"))
		{
			strBld.append("<prod:ProductCode>PRD_UK_0003</prod:ProductCode>");
		}
		if(prod.trim().equals("Relay"))
		{
			strBld.append("<prod:ProductCode>PRD_UK_0004</prod:ProductCode>");
		}
		if(prod.trim().equals("Stay Mobile"))
		{
			strBld.append("<prod:ProductCode>PRD_UK_0005</prod:ProductCode>");
		}	
		if(prod.trim().equals("BRC"))
		{
			strBld.append("<prod:ProductCode>PRD_UK_0018</prod:ProductCode>");
		}		
		
		strBld.append("</gen:Product>");
	}
	if (context.expand('${686All#NewBRC}').equals("Y"))
	{
		//strBld.append("<gen:Product><prod:ProductCode>PRD_UK_0018</prod:ProductCode></gen:Product>");
		strBld.append("<prod:VehicleAgeList>")
		if (context.expand( '${686All#NewCar1}' ) != "")
		{
			strBld.append("<prod:VehicleAge>"+context.expand( '${686All#NewCar1}' )+"</prod:VehicleAge>")
		}
		if (context.expand( '${686All#NewCar2}' ) != "")
		{
			strBld.append("<prod:VehicleAge>"+context.expand( '${686All#NewCar2}' )+"</prod:VehicleAge>")
		}
		if (context.expand( '${686All#NewCar3}' ) != "")
		{
			strBld.append("<prod:VehicleAge>"+context.expand( '${686All#NewCar3}' )+"</prod:VehicleAge>")
		}
		if (context.expand( '${686All#NewCar4}' ) != "")
		{
			strBld.append("<prod:VehicleAge>"+context.expand( '${686All#NewCar4}' )+"</prod:VehicleAge>")
		}
           strBld.append("</prod:VehicleAgeList>")
	}
}
taxtype="I";
testRunner.testCase.setPropertyValue( "MTA1_New_ProductList_XML",  strBld.toString()) //sends nodes in Request
//testRunner.testCase.setPropertyValue( "RoadList",  strBld2.toString()) //sets ROADSIDE string in Validation
//testRunner.testCase.setPropertyValue( "RoadNameList",  strBld3.toString()) //sets NAME string in Validation
testRunner.testCase.setPropertyValue( "TaxType",  taxtype.toString())
log.info(strBld)]]></script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Setup_686_NewCover_Value" id="c9b13d7b-e0a7-4dad-a04c-734fc7aad1d5">
    <con:settings/>
    <con:config>
      <script>def cover = context.expand( '${686All#NewCover_type}' )

String coverToUse = "";

if(cover.equals("V1"))
{
	coverToUse = "0";
}
if(cover.equals("P1"))
{
	coverToUse = "1";
}
if(cover.equals("P2"))
{
	coverToUse = "2";
}
if(cover.equals("P3"))
{
	coverToUse = "3";
}
if(cover.equals("P4"))
{
	coverToUse = "4";
}

def getindicator = context.expand( '${RenewalE2E#Response#declare namespace tns=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; //tns:GenerateQuoteResponse[1]/tns:CommunityOrRiskIndicator[1]}' )
testRunner.testCase.setPropertyValue( "MTA1NEWCover",  coverToUse)
testRunner.testCase.setPropertyValue( "Setindicator",  getindicator)

log.info(coverToUse)
log.info(getindicator)</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Setup_686_NewAgentDiscount_XML" id="286805d3-22cc-4acb-80f5-b84ad287b675">
    <con:settings/>
    <con:config>
      <script><![CDATA[StringBuilder strBld = new StringBuilder();
StringBuilder strBld2 = new StringBuilder();
def x 
//def AgentDiscountValue
def check_MTA_AD = context.expand('${686All#MTA AD}')
if (check_MTA_AD=="")
{
log.info "No MTA AD"
}
else
{
def d = Integer.parseInt(context.expand('${686All#MTA AD}')); 
if (d != 0)
{
	strBld.append("<prod:AgentDiscountRequestedList>");
	for( int i=1 ; i<=d; i++  ) 
	{
		if(context.expand('${686All#MTAAGENT_DISCOUNT_VALUE_' + i + '}') == "")
		{
			strBld.append("")
		}
		else
		{
			def Type = context.expand('${686All#MTAAGENT_DISCOUNT_TYPE_' + i + '}')
			
			AgentDiscountValue = context.expand('${686All#MTAAGENT_DISCOUNT_VALUE_' + i + '}')
			log.info AgentDiscountValue
			log.info(AgentDiscountValue + d )
			new_code="MTA"+i+"c"
			strBld.append("<prod:AgentDiscountRequested>");
			//strBld.append("<prod:AgentDiscountCode>" + context.expand('${242RoadAll#AGENT_DISCOUNT_CODE_' + i + '}') + "</prod:AgentDiscountCode>");
			strBld.append("<prod:AgentDiscountCode>" + new_code + "</prod:AgentDiscountCode>");
			strBld.append("<prod:AgentDiscountType>" + context.expand('${686All#MTAAGENT_DISCOUNT_TYPE_' + i + '}') + "</prod:AgentDiscountType>");
			strBld.append("<prod:AgentDiscountValue>" + AgentDiscountValue + "</prod:AgentDiscountValue>");
			strBld.append("</prod:AgentDiscountRequested>");
			x = i
		}
	}
	strBld.append("</prod:AgentDiscountRequestedList>");  
}}
//else
//{
//	strBld.append("")
//}
strBld2.append(x)
log.info(strBld)
log.info(strBld2)
testRunner.testCase.setPropertyValue( "MTAAgentDiscount_XML", strBld.toString())
//testRunner.testCase.setPropertyValue( "AgentDiscountsApplied", strBld2.toString())]]></script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Setup_686_CurrentPolicyPrice" id="1d0a7d83-8b7f-4275-b71b-a4199b2144de">
    <con:settings/>
    <con:config>
      <script><![CDATA[def productType = context.expand( '${686All#ExProduct}' )
def cover = context.expand( '${686All#ExCover_type}' )

String delimiters = "\\,|\\&";
String[] prodArr = productType.split(delimiters);
StringBuilder Strbld = new StringBuilder()

if(prodArr.length > 0)
{	

	for (prod in prodArr)
	{
			
		if(prod.trim().equals("Roadside"))
		{
			product="Roadside"
			Code="RO"
			
			if(cover.equals("V1"))
			{
				Productcode = "PRD_UK_0002"
			}
			else
			{
				Productcode = "PRD_UK_0001"
			}
			strBldS = func_AddProduct(Productcode,product,Code)
			Strbld.append(strBldS)
		}
		
		if(prod.trim().equals("HomeStart")||prod.trim().equals("Home Start"))
		{
			product= "HomeStart"
			Code="HS"
			Productcode = "PRD_UK_0003"
			strBldS = func_AddProduct(Productcode,product,Code)
			Strbld.append(strBldS)
		}
		if(prod.trim().equals("Relay"))
		{
			product= "Relay"
			Code="RE"
			Productcode = "PRD_UK_0004"
			strBldS = func_AddProduct(Productcode,product,Code)
			Strbld.append(strBldS)
		}
		if(prod.trim().equals("StayMobile")||prod.trim().equals("Stay Mobile"))
		{
			product= "StayMobile"
			Code="SM"
			Productcode = "PRD_UK_0005"
			strBldS = func_AddProduct(Productcode,product,Code)
			Strbld.append(strBldS)
		}
		
	}
	if(context.expand( '${686All#EXBRC}' ).equals("Y"))
	{
		product= "BRC"
		Code="BRC"
		Productcode = "PRD_UK_0018"
		strBldS = func_AddProduct(Productcode,product,Code)
		Strbld.append(strBldS)

		if (context.expand('${686All#EXBRC}').equals("Y"))
	{
		//strBld.append("<gen:Product><prod:ProductCode>PRD_UK_0018</prod:ProductCode></gen:Product>");
		Strbld.append("<prod:VehicleAgeList>")
		if (context.expand( '${686All#ExCar1}' ) != "")
		{
			Strbld.append("<prod:VehicleAge>"+context.expand( '${686All#ExCar1}' )+"</prod:VehicleAge>")
		}
		if (context.expand( '${686All#ExCar2}' ) != "")
		{
			Strbld.append("<prod:VehicleAge>"+context.expand( '${686All#ExCar2}' )+"</prod:VehicleAge>")
		}
		if (context.expand( '${686All#ExCar3}' ) != "")
		{
			Strbld.append("<prod:VehicleAge>"+context.expand( '${686All#ExCar3}' )+"</prod:VehicleAge>")
		}
		if (context.expand( '${686All#ExCar4}' ) != "")
		{
			Strbld.append("<prod:VehicleAge>"+context.expand( '${686All#ExCar4}' )+"</prod:VehicleAge>")
		}
           Strbld.append("</prod:VehicleAgeList>")
	}
		
	}
}


log.info(Strbld)
testRunner.testCase.setPropertyValue("RNL_Trans_MTA1_CurrentPolicyPrice_XML", Strbld.toString())

def func_AddProduct(Productcode,product,Code)
{
	
	log.info(Productcode)
	log.info(product)
	def paymenttype = context.expand( '${686All#Payment type}' )
	log.info(paymenttype)
	StringBuilder strBldN = new StringBuilder()
	//def flag = context.expand( '${686All#NB/RNL}' )
	def flag = "REN"

	
		log.info "Renewal Block"
		strBldN.append("<gen:Product>")
		strBldN.append("<prod:ProductCode>"+Productcode+"</prod:ProductCode>")
		strBldN.append("<prod:ProductPriceName>"+product+"</prod:ProductPriceName>")
		strBldN.append("<gen:PriceList>")
		strBldN.append("<prod:PolicyPrice>")
		strBldN.append("<prod:PriceElementType/>")
		strBldN.append("<prod:PriceBreakdown>")
     	strBldN.append("<prod:CorePrice>")
		strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:NetRate[1]}' )+"</prod:NetRate>")
		strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
		strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:Commission[1]}' )+"</prod:Commission>")
		strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
   		strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
 		strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
 		strBldN.append("<prod:TaxTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:TaxTotal[1]}' )+"</prod:TaxTotal>")
 		strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:Total[1]}' )+"</prod:Total>")
 		strBldN.append("</prod:CorePrice>")
 		
    	 	strBldN.append("<prod:ArrangementFee>")
		strBldN.append("<prod:Fee>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:Fee[1]}' )+"</prod:Fee>")
		strBldN.append("<prod:FeeTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:FeeTax[1]}' )+"</prod:FeeTax>")
 		strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
 		strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
  		strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:Total[1]}' )+"</prod:Total>")
     	strBldN.append("</prod:ArrangementFee>")
       
		def Offernode = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:Code[1]}' )
		log.info "Offernode-->"+Offernode
		//if((context.expand( '${686All#NB/RNL Offer}' )!= "") && (Offernode!=""))
		def persistentOffer = context.expand( '${686All#Persistent Offer}' )
		if((persistentOffer!= "") && (Offernode!=""))
   	  	{
    			strBldN.append("<prod:OfferCodeDiscountList>")
          	strBldN.append("<prod:OfferCodeDiscount>")
          	strBldN.append("<prod:Code>"+context.expand( '${686All#Persistent Offer}' )+"</prod:Code>")
          	strBldN.append("<prod:IsPersistent>true</prod:IsPersistent>")
          	strBldN.append("<prod:DiscountApplicationApproach>Product</prod:DiscountApplicationApproach>")
			strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:NetRate[1]}' )+"</prod:NetRate>")
          	strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
          	strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:Commission[1]}' )+"</prod:Commission>")
         		strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
          	strBldN.append("<prod:ArrangementFee>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:ArrangementFee[1]}' )+"</prod:ArrangementFee>")
          	strBldN.append("<prod:ArrangementFeeTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:ArrangementFeeTax[1]}' )+"</prod:ArrangementFeeTax>")
          	strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
         	 	strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
          	strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:Total[1]}' )+"</prod:Total>")
          	strBldN.append("</prod:OfferCodeDiscount>")
          	
          	persistentOffer=""

          	def RenewalOffernode = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Renewal Offer}' )+'"]/tns6:Code[1]}' )
		log.info "RenewalOffernode-->"+RenewalOffernode
		
		def RenewalOffer = context.expand( '${686All#Renewal Offer}' )
		if((RenewalOffer!= "") && (RenewalOffernode!=""))
   	  	{
    			
          	strBldN.append("<prod:OfferCodeDiscount>")
          	strBldN.append("<prod:Code>"+context.expand( '${686All#Renewal Offer}' )+"</prod:Code>")
          	strBldN.append("<prod:IsPersistent>false</prod:IsPersistent>")
          	strBldN.append("<prod:DiscountApplicationApproach>Product</prod:DiscountApplicationApproach>")
			strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:NetRate[1]}' )+"</prod:NetRate>")
          	strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
          	strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:Commission[1]}' )+"</prod:Commission>")
         		strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
          	strBldN.append("<prod:ArrangementFee>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:ArrangementFee[1]}' )+"</prod:ArrangementFee>")
          	strBldN.append("<prod:ArrangementFeeTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:ArrangementFeeTax[1]}' )+"</prod:ArrangementFeeTax>")
          	strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
         	 	strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
          	strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:Total[1]}' )+"</prod:Total>")
          	strBldN.append("</prod:OfferCodeDiscount>")
          	
		}
		strBldN.append("</prod:OfferCodeDiscountList>")
		}
		else
		{
		
		def RenewalOffernode = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Renewal Offer}' )+'"]/tns6:Code[1]}' )
		log.info "RenewalOffernode-->"+RenewalOffernode
		
		def RenewalOffer = context.expand( '${686All#Renewal Offer}' )
		if((RenewalOffer!= "") && (RenewalOffernode!=""))
   	  	{
    			strBldN.append("<prod:OfferCodeDiscountList>")
          	strBldN.append("<prod:OfferCodeDiscount>")
          	strBldN.append("<prod:Code>"+context.expand( '${686All#Renewal Offer}' )+"</prod:Code>")
          	strBldN.append("<prod:DiscountApplicationApproach>Product</prod:DiscountApplicationApproach>")
			strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:NetRate[1]}' )+"</prod:NetRate>")
          	strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
          	strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:Commission[1]}' )+"</prod:Commission>")
         		strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
          	strBldN.append("<prod:ArrangementFee>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:ArrangementFee[1]}' )+"</prod:ArrangementFee>")
          	strBldN.append("<prod:ArrangementFeeTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:ArrangementFeeTax[1]}' )+"</prod:ArrangementFeeTax>")
          	strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
         	 	strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
          	strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+RenewalOffer+'"]/tns6:Total[1]}' )+"</prod:Total>")
          	strBldN.append("</prod:OfferCodeDiscount>")
          	strBldN.append("</prod:OfferCodeDiscountList>")
		}
		}
		if (context.expand( '${686All#RNL AD}')=="")
		{
			log.info "No AD"
		}
		
		else
		{
		int AD_Count = Integer.parseInt(context.expand( '${686All#RNL AD}' ))
		if(AD_Count !="") 
		{
			def ADNode = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]}' )
	 	
	 		if (ADNode!="")
			{
				strBldN.append("<prod:AgentDiscountList>")
				for (int i=1; i<=AD_Count; i++)
				{
					strBldN.append("<prod:AgentDiscount>")
					strBldN.append("<prod:Code>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:Code[1]}' )+"</prod:Code>")
               		strBldN.append("<prod:DiscountApplicationApproach>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:DiscountApplicationApproach[1]}' )+"</prod:DiscountApplicationApproach>")
              			 strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:NetRate[1]}' )+"</prod:NetRate>")
              			 strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
              	 		strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:Commission[1]}' )+"</prod:Commission>")
               		strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
               		strBldN.append("<prod:ArrangementFee>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:ArrangementFee[1]}' )+"</prod:ArrangementFee>")
               		strBldN.append("<prod:ArrangementFeeTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:ArrangementFeeTax[1]}' )+"</prod:ArrangementFeeTax>")
              		 	strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
               		strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
               		strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:Total[1]}' )+"</prod:Total>")
               		strBldN.append("</prod:AgentDiscount>")
              	 	}
				strBldN.append("</prod:AgentDiscountList>")
			}
		}}
		strBldN.append("<prod:AccountingTotals>")
		strBldN.append("<prod:CoreDiscountsTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreDiscountsTotal[1]}' )+"</prod:CoreDiscountsTotal>")
		strBldN.append("<prod:CoreDiscountsTaxTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreDiscountsTaxTotal[1]}' )+"</prod:CoreDiscountsTaxTotal>")
		strBldN.append("<prod:CoreCommissionDiscountsTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreCommissionDiscountsTotal[1]}' )+"</prod:CoreCommissionDiscountsTotal>")
		strBldN.append("<prod:CoreNetRateDiscountsTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreNetRateDiscountsTotal[1]}' )+"</prod:CoreNetRateDiscountsTotal>")
		strBldN.append("<prod:ArrangementFeeGrandDiscountsTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:ArrangementFeeGrandDiscountsTotal[1]}' )+"</prod:ArrangementFeeGrandDiscountsTotal>")
		strBldN.append("<prod:ArrangementFeeTaxDiscountsTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:ArrangementFeeTaxDiscountsTotal[1]}' )+"</prod:ArrangementFeeTaxDiscountsTotal>")
		strBldN.append("<prod:ArrangementFeeDiscountsTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:ArrangementFeeDiscountsTotal[1]}' )+"</prod:ArrangementFeeDiscountsTotal>")
		strBldN.append("</prod:AccountingTotals>")
		strBldN.append("</prod:PriceBreakdown>")

		strBldN.append("<prod:TaxType>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TaxType[1]}' )+"</prod:TaxType>")
		strBldN.append("<prod:TaxDate>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TaxDate[1]}' )+"</prod:TaxDate>")
		strBldN.append("<prod:DateInceptedOnPolicy>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:DateInceptedOnPolicy[1]}' )+"</prod:DateInceptedOnPolicy>")
    		strBldN.append("<prod:RelativityPriceFactor>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:RelativityPriceFactor[1]}' )+"</prod:RelativityPriceFactor>")
     	strBldN.append("<prod:ExtrapolationFactor>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:ExtrapolationFactor[1]}' )+"</prod:ExtrapolationFactor>")
      	strBldN.append("<prod:ArrangementFeeTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:ArrangementFeeTotal[1]}' )+"</prod:ArrangementFeeTotal>")
  		strBldN.append("<prod:TotalLessArrangementFeeTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TotalLessArrangementFeeTotal[1]}' )+"</prod:TotalLessArrangementFeeTotal>")
     	strBldN.append("<prod:TotalLessDiscounts>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TotalLessDiscounts[1]}' )+"</prod:TotalLessDiscounts>")
     	strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:Total[1]}' )+"</prod:Total>")
		strBldN.append("</prod:PolicyPrice>")
		strBldN.append("</gen:PriceList>")
		strBldN.append("<prod:InsideCoolingOffFlag>"+context.expand( '${686All#COOLINGOFF FLAG_'+Code+'}' )+"</prod:InsideCoolingOffFlag>")
		strBldN.append("<prod:FullRefundFlag>false</prod:FullRefundFlag>")
		strBldN.append("<prod:PaidPeriods>"+context.expand( '${686All#PaidPeriod_'+Code+'}' )+"</prod:PaidPeriods>")

		strBldN.append("</gen:Product>")
	return (strBldN)

}]]></script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Setup_686_TransPolicyPrice" id="b2830038-b1bf-4ba7-80df-0a28bc524b77">
    <con:settings/>
    <con:config>
      <script><![CDATA[def productType = context.expand( '${686All#ExProduct}' )
def cover = context.expand( '${686All#ExCover_type}' )
def id = context.expand( '${686All#ID}' )
log.info id
String delimiters = "\\,|\\&";
String[] prodArr = productType.split(delimiters);
StringBuilder Strbld = new StringBuilder()

if(prodArr.length > 0)
{	
	for (prod in prodArr)
	
	{
			if(prod.trim().equals("Roadside"))
		{
			product="Roadside"
			if(cover.equals("V1"))
			{
				Productcode = "PRD_UK_0002"
			}
			else
			{
				Productcode = "PRD_UK_0001"
			}
			strBldS = func_AddProduct(Productcode,product)
			Strbld.append(strBldS)
		}
		if(prod.trim().equals("HomeStart")||prod.trim().equals("Home Start"))
		{
			product= "HomeStart"
			Productcode = "PRD_UK_0003"
			strBldS = func_AddProduct(Productcode,product)
			Strbld.append(strBldS)
		}
		if(prod.trim().equals("Relay"))
		{
			product= "Relay"
			Productcode = "PRD_UK_0004"
			strBldS = func_AddProduct(Productcode,product)
			Strbld.append(strBldS)
		}
		if(prod.trim().equals("StayMobile")||prod.trim().equals("Stay Mobile"))
		{
			product= "StayMobile"
			Productcode = "PRD_UK_0005"
			strBldS = func_AddProduct(Productcode,product)
			Strbld.append(strBldS)
		}
		if(prod.trim().equals("Basic Breakdown Cover"))
		{
			product= "BasicBreakdown"
			Productcode = "PRD_UK_0020"
			strBldS = func_AddProduct(Productcode,product)
			Strbld.append(strBldS)
		}
		if(prod.trim().equals("ROCO"))
		{
			product= "ROCO"
			Productcode = "PRD_UK_0021"
			strBldS = func_AddProduct(Productcode,product)
			Strbld.append(strBldS)
		}
		if(prod.trim().equals("ROPOV"))
		{
			product= "ROPOV"
			Productcode = "PRD_UK_0023"
			strBldS = func_AddProduct(Productcode,product)
			Strbld.append(strBldS)
		}
		if(prod.trim().equals("Local Driver"))
		{
			product= "LocalDriver"
			Productcode = "PRD_UK_0022"
			strBldS = func_AddProduct(Productcode,product)
			Strbld.append(strBldS)
		}
		if(prod.trim().equals("Start Up"))
		{
			product= "StartUp"
			Productcode = "PRD_UK_0024"
			strBldS = func_AddProduct(Productcode,product)
			Strbld.append(strBldS)
		}
		if(prod.trim().equals("Standby"))
		{
			product= "Standby"
			Productcode = "PRD_UK_0030"
			strBldS = func_AddProduct(Productcode,product)
			Strbld.append(strBldS)
		}
	}
	if(context.expand( '${686All#EXBRC}' ).equals("Y"))
	{
		product= "BRC"
		Productcode = "PRD_UK_0018"
		strBldS = func_AddProduct(Productcode,product)
		Strbld.append(strBldS)
	}
}

log.info(Strbld)
testRunner.testCase.setPropertyValue("RNL_Trans_MTA1_TransPrice_XML", Strbld.toString())

def func_AddProduct(Productcode,product)
{
	log.info(Productcode)
	log.info(product)
	def paymenttype = context.expand( '${686All#Payment type}' )
	log.info(paymenttype)
	StringBuilder strBldN = new StringBuilder()
	//def flag = context.expand( '${658All#NB/RNL}' )
	def flag = "REN"
	log. info flag
	
		strBldN.append("<gen:TransactionProduct>")
		strBldN.append("<prod:ProductCode>"+Productcode+"</prod:ProductCode>")
		strBldN.append("<prod:ProductPriceName>"+product+"</prod:ProductPriceName>")
		strBldN.append("<gen:TransactionPriceList>")
		strBldN.append("<prod:Price>")
		strBldN.append("<prod:PriceElementType/>")
		strBldN.append("<prod:PriceBreakdown>")
     	strBldN.append("<prod:CorePrice>")
		strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:NetRate[1]}' )+"</prod:NetRate>")
		strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
		strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:Commission[1]}' )+"</prod:Commission>")
		strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
   		strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
 		strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
 		strBldN.append("<prod:TaxTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:TaxTotal[1]}' )+"</prod:TaxTotal>")
 		strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:CorePrice[1]/tns6:Total[1]}' )+"</prod:Total>")
 		strBldN.append("</prod:CorePrice>")
 		
    	 	strBldN.append("<prod:ArrangementFee>")
		strBldN.append("<prod:Fee>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:Fee[1]}' )+"</prod:Fee>")
		strBldN.append("<prod:FeeTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:FeeTax[1]}' )+"</prod:FeeTax>")
 		strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
 		strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
  		strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:ArrangementFee[1]/tns6:Total[1]}' )+"</prod:Total>")
     	strBldN.append("</prod:ArrangementFee>")
       
		def Offernode = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:Code[1]}' )
		
		//if((context.expand( '${686All#Persistent Offer}' )!= "") && (Offernode!=""))
		def persistentOffer = context.expand( '${686All#Persistent Offer}' )
		if((persistentOffer!= "") && (Offernode!=""))
   	  	{
    			strBldN.append("<prod:OfferCodeDiscountList>")
          	strBldN.append("<prod:OfferCodeDiscount>")
          	strBldN.append("<prod:Code>"+context.expand( '${686All#Persistent Offer}' )+"</prod:Code>")
          	strBldN.append("<prod:DiscountApplicationApproach>Product</prod:DiscountApplicationApproach>")
			strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:NetRate[1]}' )+"</prod:NetRate>")
          	strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
          	strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:Commission[1]}' )+"</prod:Commission>")
         		strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
          	strBldN.append("<prod:ArrangementFee>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:ArrangementFee[1]}' )+"</prod:ArrangementFee>")
          	strBldN.append("<prod:ArrangementFeeTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:ArrangementFeeTax[1]}' )+"</prod:ArrangementFeeTax>")
          	strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
         	 	strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
          	strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:OfferCodeDiscountList[1]/tns6:OfferCodeDiscount[tns6:Code ="'+context.expand( '${686All#Persistent Offer}' )+'"]/tns6:Total[1]}' )+"</prod:Total>")
          	strBldN.append("</prod:OfferCodeDiscount>")
          	strBldN.append("</prod:OfferCodeDiscountList>")
		}
		if (context.expand( '${686All#RNL AD}')=="")
		{
			log.info "No AD"
		}
		
		else
		{
		int AD_Count = Integer.parseInt(context.expand( '${686All#RNL AD}' ))
		if(AD_Count !="") 
		{
			def ADNode = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]}' )
	 	
	 		if (ADNode!="")
			{
				strBldN.append("<prod:AgentDiscountList>")
				for (int i=1; i<=AD_Count; i++)
				{
					strBldN.append("<prod:AgentDiscount>")
					strBldN.append("<prod:Code>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:Code[1]}' )+"</prod:Code>")
               		strBldN.append("<prod:DiscountApplicationApproach>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:DiscountApplicationApproach[1]}' )+"</prod:DiscountApplicationApproach>")
              			 strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:NetRate[1]}' )+"</prod:NetRate>")
              			 strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
              	 		strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:Commission[1]}' )+"</prod:Commission>")
               		strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
               		strBldN.append("<prod:ArrangementFee>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:ArrangementFee[1]}' )+"</prod:ArrangementFee>")
               		strBldN.append("<prod:ArrangementFeeTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:ArrangementFeeTax[1]}' )+"</prod:ArrangementFeeTax>")
              		 	strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
               		strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
               		strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AgentDiscountList[1]/tns6:AgentDiscount['+ i +']/tns6:Total[1]}' )+"</prod:Total>")
               		strBldN.append("</prod:AgentDiscount>")
              	 	}
				strBldN.append("</prod:AgentDiscountList>")
			}
		}}
		//system discount for reprice threshold
		def PriceUpheld = context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; //tns8:GenerateQuoteResponse[1]/tns8:RepriceDetailsResponse[1]/tns8:OriginalPriceUpheld[1]}' )
		if (PriceUpheld == "true")
		{
			strBldN.append("<prod:SystemDiscountList>")
         		strBldN.append("<prod:SystemDiscount>")
        	  	strBldN.append("<prod:Code>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[tns6:Code="Waive_C"]/tns6:Code[1]}' )+"</prod:Code>")
          	strBldN.append("<prod:SystemDiscountCategory>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[tns6:Code="Waive_C"]/tns6:SystemDiscountCategory[1]}' )+"</prod:SystemDiscountCategory>")
         		strBldN.append("<prod:DiscountApplicationApproach>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[tns6:Code="Waive_C"]/tns6:DiscountApplicationApproach[1]}' )+"</prod:DiscountApplicationApproach>")
          	strBldN.append("<prod:NetRate>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[tns6:Code="Waive_C"]/tns6:NetRate[1]}' )+"</prod:NetRate>")
          	strBldN.append("<prod:NetRateTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[tns6:Code="Waive_C"]/tns6:NetRateTax[1]}' )+"</prod:NetRateTax>")
          	strBldN.append("<prod:Commission>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[tns6:Code="Waive_C"]/tns6:Commission[1]}' )+"</prod:Commission>")
          	strBldN.append("<prod:CommissionTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[tns6:Code="Waive_C"]/tns6:CommissionTax[1]}' )+"</prod:CommissionTax>")
          	strBldN.append("<prod:ArrangementFee>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[tns6:Code="Waive_C"]/tns6:ArrangementFee[1]}' )+"</prod:ArrangementFee>")
          	strBldN.append("<prod:ArrangementFeeTax>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[tns6:Code="Waive_C"]/tns6:ArrangementFeeTax[1]}' )+"</prod:ArrangementFeeTax>")
          	strBldN.append("<prod:InternallyFundedDiscount>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[tns6:Code="Waive_C"]/tns6:InternallyFundedDiscount[1]}' )+"</prod:InternallyFundedDiscount>")
         	 	strBldN.append("<prod:TaxPercentage>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[tns6:Code="Waive_C"]/tns6:TaxPercentage[1]}' )+"</prod:TaxPercentage>")
         	 	strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:SystemDiscountList[1]/tns6:SystemDiscount[tns6:Code="Waive_C"]/tns6:Total[1]}' )+"</prod:Total>")
          	strBldN.append("</prod:SystemDiscount>")
          	strBldN.append("</prod:SystemDiscountList>")
		}
		strBldN.append("<prod:AccountingTotals>")
		strBldN.append("<prod:CoreDiscountsTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreDiscountsTotal[1]}' )+"</prod:CoreDiscountsTotal>")
		strBldN.append("<prod:CoreDiscountsTaxTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreDiscountsTaxTotal[1]}' )+"</prod:CoreDiscountsTaxTotal>")
		strBldN.append("<prod:CoreCommissionDiscountsTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreCommissionDiscountsTotal[1]}' )+"</prod:CoreCommissionDiscountsTotal>")
		strBldN.append("<prod:CoreNetRateDiscountsTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:CoreNetRateDiscountsTotal[1]}' )+"</prod:CoreNetRateDiscountsTotal>")
		strBldN.append("<prod:ArrangementFeeGrandDiscountsTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:ArrangementFeeGrandDiscountsTotal[1]}' )+"</prod:ArrangementFeeGrandDiscountsTotal>")
		strBldN.append("<prod:ArrangementFeeTaxDiscountsTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:ArrangementFeeTaxDiscountsTotal[1]}' )+"</prod:ArrangementFeeTaxDiscountsTotal>")
		strBldN.append("<prod:ArrangementFeeDiscountsTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:PriceBreakdown[1]/tns6:AccountingTotals[1]/tns6:ArrangementFeeDiscountsTotal[1]}' )+"</prod:ArrangementFeeDiscountsTotal>")
		strBldN.append("</prod:AccountingTotals>")
		strBldN.append("</prod:PriceBreakdown>")

		strBldN.append("<prod:TaxType>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TaxType[1]}' )+"</prod:TaxType>")
		strBldN.append("<prod:TaxDate>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TaxDate[1]}' )+"</prod:TaxDate>")
		strBldN.append("<prod:DateInceptedOnPolicy>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:DateInceptedOnPolicy[1]}' )+"</prod:DateInceptedOnPolicy>")
    		strBldN.append("<prod:RelativityPriceFactor>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:RelativityPriceFactor[1]}' )+"</prod:RelativityPriceFactor>")
     	strBldN.append("<prod:ExtrapolationFactor>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:ExtrapolationFactor[1]}' )+"</prod:ExtrapolationFactor>")
      	strBldN.append("<prod:ArrangementFeeTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:ArrangementFeeTotal[1]}' )+"</prod:ArrangementFeeTotal>")
  		strBldN.append("<prod:TotalLessArrangementFeeTotal>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TotalLessArrangementFeeTotal[1]}' )+"</prod:TotalLessArrangementFeeTotal>")
     	strBldN.append("<prod:TotalLessDiscounts>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:TotalLessDiscounts[1]}' )+"</prod:TotalLessDiscounts>")
     	strBldN.append("<prod:Total>"+context.expand( '${RenewalE2E YR2#Response#declare namespace tns8=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_RNL_3\'; declare namespace tns6=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns8:GenerateQuoteResponse[1]/tns8:ProductList[1]/tns6:Payment[1]/tns6:Product[tns6:ProductCode="'+Productcode+'"]/tns6:PriceList[1]/tns6:Price[1]/tns6:Total[1]}' )+"</prod:Total>")
		strBldN.append("</prod:Price>")
		strBldN.append("</gen:TransactionPriceList>")
		if (product =="BRC")
		{
			strBldN.append("<prod:VehicleAgeList>")
			strBldN.append("<prod:VehicleAge>"+context.expand( '${686All#EXCar1}' )+"</prod:VehicleAge>")
		
			if (context.expand( '${686All#EXCar2}' ) != "")
			{
				strBldN.append("<prod:VehicleAge>"+context.expand( '${686All#EXCar2}' )+"</prod:VehicleAge>")
			}
			if (context.expand( '${686All#EXCar3}' ) != "")
			{
				strBldN.append("<prod:VehicleAge>"+context.expand( '${686All#EXCar3}' )+"</prod:VehicleAge>")
			}
			if (context.expand( '${686All#EXCar4}' ) != "")
			{
				strBldN.append("<prod:VehicleAge>"+context.expand( '${686All#EXCar4}' )+"</prod:VehicleAge>")
			}
           	strBldN.append("</prod:VehicleAgeList>")
		}
		strBldN.append("</gen:TransactionProduct>")
		
		return (strBldN)

}]]></script>
    </con:config>
  </con:testStep>
  <con:testStep type="request" id="106d766c-8876-4181-aa1c-c047ee589911" name="686Request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>SOAPServiceBindingMTA</con:interface>
      <con:operation>GenerateQuote</con:operation>
      <con:request name="686Request" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="b984e810-397e-41e6-898e-e77fcf7a3e2c">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://rh0124v:18027/SOAPServiceBinding/BSROS_GenerateQuote_MTA/</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:gen="http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3" xmlns:mes="http://www.theaa.com/CommonServices/Data/Message/MessageHeader.2" xmlns:com="http://www.theaa.com/CommonServices/Data/Common" xmlns:prod="http://www.theaa.com/CommonServices/Data/Product.2">
   <soapenv:Header/>
   <soapenv:Body>
      <gen:GenerateQuoteRequest xmlns="http://www.theaa.com/CommonServices/Data/Common" xmlns:ns5="http://www.theaa.com/CommonServices/Data/Common.2">
         <mes:RequestHeader>
            <mes:TransactionId>RO-MTA-1712-719</mes:TransactionId>
            <mes:Version>1.0</mes:Version>
            <mes:RequestDateTime>${#TestCase#RequestDateTime}</mes:RequestDateTime>
            <mes:Source>
               <mes:Domain>SALES</mes:Domain>
               <mes:Channel>SanityTesting</mes:Channel>
               <mes:LineOfBusiness>ROS</mes:LineOfBusiness>
               <mes:Name>Pricing Services</mes:Name>
               <mes:User>PS Testing</mes:User>
            </mes:Source>
         </mes:RequestHeader>
         <gen:IndicativePriceFlag>true</gen:IndicativePriceFlag>
         <prod:FlexFactorOnCurrentPolicy>${686All#FlexFactor}</prod:FlexFactorOnCurrentPolicy>
         <prod:CommunityOrRiskIndicator>${#TestCase#Setindicator}</prod:CommunityOrRiskIndicator>
         <prod:Currency>GBP</prod:Currency>
         <gen:TradeUp>false</gen:TradeUp>
         <gen:ManConYear1>false</gen:ManConYear1>
         <gen:MTAReason>Make a Change</gen:MTAReason>
         <gen:MTACode>ABC</gen:MTACode>
         <gen:FreeMonths>0</gen:FreeMonths>
         <gen:PaymentType>${686All#Payment type}</gen:PaymentType>
         <gen:NewProductList>
            <prod:EffectivePriceDateTime>${686All#MTA Date}T00:00:00</prod:EffectivePriceDateTime>
            <prod:PolicyStartDateTime>${686All#POLICYSTARTDATE}T00:00:00</prod:PolicyStartDateTime>
            <prod:PolicyEndDateTime>${686All#POLICYENDDATE}T00:00:00</prod:PolicyEndDateTime>
            <prod:OfferCodeDetailList>
               <prod:OfferCodeDetail>
                  <prod:OfferCode>${686All#Persistent Offer}</prod:OfferCode>
                  <prod:OfferCodeApplicationLevel>1</prod:OfferCodeApplicationLevel>
                  <prod:IsPersistent>true</prod:IsPersistent>
               </prod:OfferCodeDetail>
               <prod:OfferCodeDetail>
                  <prod:OfferCode>${686All#MTA Offer}</prod:OfferCode>
                  <prod:OfferCodeApplicationLevel>2</prod:OfferCodeApplicationLevel>
                  <prod:IsPersistent>false</prod:IsPersistent>
               </prod:OfferCodeDetail>
            </prod:OfferCodeDetailList>
            <prod:SourceCode>Natural Search</prod:SourceCode>
            ${#TestCase#MTA1_New_ProductList_XML}
            <gen:CoveredPersons>${#TestCase#MTA1NEWCover}</gen:CoveredPersons>
            ${#TestCase#MTAAgentDiscount_XML}
            <!--<prod:MultiplyingFactor>${686All#Multiplying Factor}</prod:MultiplyingFactor>-->
         </gen:NewProductList>
         <gen:CustomerDetails>
            <gen:Postcode>RG21 7AS</gen:Postcode>
            <gen:MembershipStatus>
               <gen:IsMember>true</gen:IsMember>
               <gen:MembershipTenure>0</gen:MembershipTenure>
            </gen:MembershipStatus>
         </gen:CustomerDetails>
         ${#TestCase#MTAFeeList_XML}
         <gen:CurrentPolicyDetails>
            <prod:PaymentType>${686All#Payment type}</prod:PaymentType>
            <prod:PolicyStartDateTime>${686All#POLICYSTARTDATE}T00:00:00</prod:PolicyStartDateTime>
            <prod:PolicyEndDateTime>${686All#POLICYENDDATE}T00:00:00</prod:PolicyEndDateTime>
            <prod:CoveredPersons>${#TestCase#Cover}</prod:CoveredPersons>
            <prod:Currency>GBP</prod:Currency>
            ${#TestCase#RNL_Trans_MTA1_CurrentPolicyPrice_XML}
         </gen:CurrentPolicyDetails>
         <gen:TransactionRecordList>
            <gen:TransactionRecord>
               <gen:Transaction>${#TestCase#Transaction}</gen:Transaction>
               <gen:TransactionRequestDateTime>${686All#POLICYSTARTDATE}T00:00:00</gen:TransactionRequestDateTime>
               <gen:TransactionStartDateTime>${686All#POLICYSTARTDATE}T00:00:00</gen:TransactionStartDateTime>
               <gen:TransactionProductList>
                  <prod:PaymentType>${686All#Payment type}</prod:PaymentType>
                  <prod:CoveredPersons>${#TestCase#Cover}</prod:CoveredPersons>
                  <prod:Currency>GBP</prod:Currency>
                  ${#TestCase#RNL_Trans_MTA1_TransPrice_XML}
                  <prod:SurchargeFeeList>
                     <prod:SurchargeFee>
                        <prod:Code>Cancellation1</prod:Code>
                        <prod:SurchargeRequestType>A</prod:SurchargeRequestType>
                        <prod:IsWaived>false</prod:IsWaived>
                        <prod:TaxType>I</prod:TaxType>
                        <prod:Fee>17.86</prod:Fee>
                        <prod:FeeTax>2.14</prod:FeeTax>
                        <prod:TaxPercentage>0.12</prod:TaxPercentage>
                        <prod:Total>20.0</prod:Total>
                     </prod:SurchargeFee>
                     <prod:SurchargeFee>
                        <prod:Code>Cancellation2</prod:Code>
                        <prod:SurchargeRequestType>A</prod:SurchargeRequestType>
                        <prod:IsWaived>false</prod:IsWaived>
                        <prod:TaxType>I</prod:TaxType>
                        <prod:Fee>5.36</prod:Fee>
                        <prod:FeeTax>0.64</prod:FeeTax>
                        <prod:TaxPercentage>0.12</prod:TaxPercentage>
                        <prod:Total>6.0</prod:Total>
                     </prod:SurchargeFee>
                     <prod:SurchargeFee>
                        <prod:Code>WillJoinCanx</prod:Code>
                        <prod:SurchargeRequestType>A</prod:SurchargeRequestType>
                        <prod:IsWaived>false</prod:IsWaived>
                        <prod:TaxType>V</prod:TaxType>
                        <prod:Fee>82.5</prod:Fee>
                        <prod:FeeTax>16.5</prod:FeeTax>
                        <prod:TaxPercentage>0.2</prod:TaxPercentage>
                        <prod:Total>99.0</prod:Total>
                     </prod:SurchargeFee>
                  </prod:SurchargeFeeList>
               </gen:TransactionProductList>
            </gen:TransactionRecord>
         </gen:TransactionRecordList>
      </gen:GenerateQuoteRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508" action="GenerateQuote"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Save xml" id="2dfbc92b-ae83-4320-878e-7e2499eb5aeb" disabled="true">
    <con:settings/>
    <con:config>
      <script>now=new java.text.SimpleDateFormat("yyyyMMdd'T'HHmmss").format(new Date())
//Save response

def directory = "N:/Systems_development/RIO/Road MTA-CR-242/Soap UI/Test Results/RCR-686/XML"
def scenarioNo = context.expand( '${686All#ID}' )
def requestFile = new File(directory, "${scenarioNo}_requestMTA"+ now +".xml")
requestFile.append( context.expand('${686Request#Request}') )
//def responseFile = new File(directory, "${scenarioNo}_response"+ now +".xml")
//responseFile.append( context.expand('${686Request#Response}') )</script>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Validate_686" id="76a723db-e7bf-4ecc-9fe9-1edcb4fb2702">
    <con:settings/>
    <con:config>
      <script>import java.text.DecimalFormat;
int numOfIterations = Integer.parseInt(context.expand( '${#TestCase#NumOfIterations}' ))
numOfIterations++
testRunner.testCase.setPropertyValue("NumOfIterations", new Integer(numOfIterations).toString())
def id = context.expand( '${686All#ID}' )
def payment = context.expand( '${686All#Payment type}' )
log.info id


// Check what Products to validate for transaction price
def ExproductType = context.expand( '${686All#EXPRODUCT}' )
def NewproductType = context.expand( '${686All#NEWPRODUCT}' )
//def newString = ExproductType + ","+NewproductType

def productType = context.expand( '${686All#NEWPRODUCT}' )

String delimiters = "\\,|\\&amp;";
//String[] prodArr = newString.split(delimiters);
String[] prodArr = productType.split(delimiters);
StringBuilder strBld = new StringBuilder();
def roadcount = 1
def hscount = 1
def recount = 1
def smcount = 1

//validate individual product
if(prodArr.length > 0)
{

	for (prod in prodArr)
	{
		
		if(prod.trim().equals("Roadside"))
		{
			product= "Roadside"
			if (roadcount.equals(2) )
			{
				log.info ("not doing it again road")
			}
			else
			{
				func_Check(productType,product,"RO",payment,id)
				roadcount++
			}
		}
		if(prod.trim().equals("Home Start"))
		{
			product= "HomeStart"
			if (hscount.equals(2) )
			{
				log.info ("not doing it again")
			}
			else
			{
				func_Check(productType,product,"HS",payment,id)
				hscount++
			}
		}
		if(prod.trim().equals("Relay"))
		{
			product= "Relay"
			if (recount.equals(2) )
			{
				log.info ("not doing it again")
			}
			else
			{
				func_Check(productType,product,"RE",payment,id)
				recount++
			}
		}
		if(prod.trim().equals("Stay Mobile"))
		{
			product= "StayMobile"
			if (smcount.equals(2) )
			{
				log.info ("not doing it again")
			}
			else
			{
				smcount++
				func_Check(productType,product,"SM",payment,id)
			}
		}	
	}
}

if (context.expand('${686All#NewBRC}').equals("Y"))
{
	func_Check(productType,"BRC","BRC",payment,id)
}


//Transaction Price Breakdown

def response = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:Total[1]}' )


def GrandTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:Total[1]}' )
def GrandTotalExcDisc = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:TotalExcludingDiscounts[1]}' )
def DiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:DiscountTotal[1]}' )
def BaseCoverTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:BaseCoverTotal[1]}' )
def BaseCoverTotalLessDisc = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:BaseCoverTotalLessDiscounts[1]}' )
def BaseCoverAAFTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:BaseCoverArrangementFeeTotal[1]}' )
def TotalAAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:TotalArrangementFee[1]}' )
def FeeTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:SurchargeFeeTotal[1]}' )
def TotalLessTotalAAFAddons = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:TotalLessTotalAAFAndTotalAddons[1]}' )
def TotalLessFees = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:TotalLessSurchargeFees[1]}' )
def TotalLessAAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:TotalLessArrangementFees[1]}' )
def TotalIPT = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:TotalIPT[1]}' )
def TotalVAT = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:TotalPriceBreakdown[1]/tns1:TotalVAT[1]}' )
def TransSubType = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.2\'; //tns3:GenerateQuoteResponse[1]/tns3:TransactionSubType[1]}' )
		
	func_write(payment,"TotalPriceBreakdown,CombinedTotal","",GrandTotal)
	func_write(payment,"TotalPriceBreakdown,TotalLessDisc","",GrandTotalExcDisc)
	func_write(payment,"TotalPriceBreakdown,DiscountsTotal","",DiscTotal)
	func_write(payment,"TotalPriceBreakdown,BaseCoverTotal","",BaseCoverTotal)
	func_write(payment,"TotalPriceBreakdown,BaseCoverLessDisc","",BaseCoverTotalLessDisc)
	func_write(payment,"TotalPriceBreakdown,BaseCoverAAFTotal","",BaseCoverAAFTotal)
	func_write(payment,"TotalPriceBreakdown,TotalAAF","",TotalAAF)
	func_write(payment,"TotalPriceBreakdown,TotalFee","",FeeTotal)
	func_write(payment,"TotalPriceBreakdown,TotalLessAAFLessAddons","",TotalLessTotalAAFAddons)
	func_write(payment,"TotalPriceBreakdown,TotalLessFee","",TotalLessFees)
	func_write(payment,"TotalPriceBreakdown,TotalLessAAF","",TotalLessAAF)
	func_write(payment,"TotalPriceBreakdown,TotalVAT","",TotalVAT)
	func_write(payment,"TotalPriceBreakdown,TotalIPT","",TotalIPT)
	func_write(payment,"TotalPriceBreakdown,TransSubType","",TransSubType)



 //Policy Price Breakdown
def P_GrandTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:PolicyTotalPriceBreakdown[1]/tns1:Total[1]}' )
def P_GrandTotalExcDisc = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:PolicyTotalPriceBreakdown[1]/tns1:TotalExcludingDiscounts[1]}' )
def P_DiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:PolicyTotalPriceBreakdown[1]/tns1:DiscountTotal[1]}' )
def P_BaseCoverTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:PolicyTotalPriceBreakdown[1]/tns1:BaseCoverTotal[1]}' )
def P_BaseCoverTotalLessDisc = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:PolicyTotalPriceBreakdown[1]/tns1:BaseCoverTotalLessDiscounts[1]}' )
def P_BaseCoverAAFTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:PolicyTotalPriceBreakdown[1]/tns1:BaseCoverArrangementFeeTotal[1]}' )
def P_TotalAAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:PolicyTotalPriceBreakdown[1]/tns1:TotalArrangementFee[1]}' )
def P_FeeTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:PolicyTotalPriceBreakdown[1]/tns1:SurchargeFeeTotal[1]}' )
def P_TotalLessTotalAAFAddons = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:PolicyTotalPriceBreakdown[1]/tns1:TotalLessTotalAAFAndTotalAddons[1]}' )
def P_TotalLessFees = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:PolicyTotalPriceBreakdown[1]/tns1:TotalLessSurchargeFees[1]}' )
def P_TotalLessAAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:PolicyTotalPriceBreakdown[1]/tns1:TotalLessArrangementFees[1]}' )
def P_TotalIPT = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:PolicyTotalPriceBreakdown[1]/tns1:TotalIPT[1]}' )
func_write(payment,"Policy,CombinedTotal","",P_GrandTotal)
	func_write(payment,"Policy,TotalLessDisc","",P_GrandTotalExcDisc)
	func_write(payment,"Policy,DiscountsTotal","",P_DiscTotal)
	func_write(payment,"Policy,BaseCoverTotal","",P_BaseCoverTotal)
	func_write(payment,"Policy,BaseCoverLessDisc","",P_BaseCoverTotalLessDisc)
	func_write(payment,"Policy,BaseCoverAAFTotal","",P_BaseCoverAAFTotal)
	func_write(payment,"Policy,TotalAAF","",P_TotalAAF)
	func_write(payment,"Policy,TotalFee","",P_FeeTotal)
	func_write(payment,"Policy,TotalLessAAFLessAddons","",P_TotalLessTotalAAFAddons)
	func_write(payment,"Policy,TotalLessFee","",P_TotalLessFees)
	func_write(payment,"Policy,TotalLessAAF","",P_TotalLessAAF)
	func_write(payment,"Policy,TotalIPT","",P_TotalIPT)


if(context.expand( '${686All#NEWBRC}' )=="Y" || context.expand( '${686All#EXBRC}' )=="Y")
{
	product= "BRC"
	func_Check(productType,product,"BRC",payment,id)
}		

def func_Check(productType,product,name,payment,id)
{
	log.info product
	log.info id
	//Transaction price
	def CoreNet = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:CorePrice[1]/tns1:NetRate[1]}' )
	def CoreNetTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:CorePrice[1]/tns1:NetRateTax[1]}' )
	def CoreComm = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:CorePrice[1]/tns1:Commission[1]}' )
	def CoreCommTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:CorePrice[1]/tns1:CommissionTax[1]}' )
	def TaxTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:CorePrice[1]/tns1:TaxTotal[1]}' )
	def CoreTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:CorePrice[1]/tns1:Total[1]}' )
	def AAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:ArrangementFee[1]/tns1:Fee[1]}' )
	def AAFTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:ArrangementFee[1]/tns1:FeeTax[1]}' )
	def AAFTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:ArrangementFee[1]/tns1:Total[1]}' )
	def CoreDiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:CoreDiscountsTotal[1]}' )
	def CoreDiscTaxTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:CoreDiscountsTaxTotal[1]}' )
	def CoreCommDiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:CoreCommissionDiscountsTotal[1]}' )
	def CoreNetDiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:CoreNetRateDiscountsTotal[1]}' )
	def AAFGrandDiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:ArrangementFeeGrandDiscountsTotal[1]}' )
	def AAFTaxDiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:ArrangementFeeTaxDiscountsTotal[1]}' )
	def AAFDiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:ArrangementFeeDiscountsTotal[1]}' )
	def ProdRel = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:RelativityPriceFactor[1]}' )
	def ProdAAFTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:ArrangementFeeTotal[1]}' )
	def ProdTotalLessAAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:TotalLessArrangementFeeTotal[1]}' )
	def ProdTotalLessDisc = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:TotalLessDiscounts[1]}' )
	def ProdTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:Total[1]}' )

	func_write(payment,"CORE,Net",product,CoreNet)
	func_write(payment,"CORE,NetTax",product,CoreNetTax)
	func_write(payment,"CORE,Commission",product,CoreComm)
	func_write(payment,"CORE,CommissionTax",product,CoreCommTax)
	func_write(payment,"CORE,TaxTotal",product,TaxTotal)
	func_write(payment,"CORE,Total",product,CoreTotal)
	func_write(payment,"AAF,AAF",product,AAF)
	func_write(payment,"AAF,AAFTax",product,AAFTax)
	func_write(payment,"AAF,Total",product,AAFTotal)

	//Transaction Offer validation
	def OFFER = ""
	def OLDOFFER = context.expand('${686All#Persistent Offer}')
	log.info OLDOFFER
	def OfferNode = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:Code[1]}' )
	def Offernet3,OffernetTax3,Offercomm3,OffercommTax3,OfferAAF3,OfferAAFTax3,OfferIFD3,OfferTotal3
	log.info "Offernode -->"  + OfferNode
	if (OLDOFFER !="") // if old offer needs to be clawed back
	{
		def OldOfferNode = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:Code[1]}' )
		if (OldOfferNode !="")
		{
			Offernet3 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:NetRate[1]}' )
			OffernetTax3 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:NetRateTax[1]}' )
			Offercomm3 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:Commission[1]}' )
			OffercommTax3 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:CommissionTax[1]}' )
			OfferAAF3 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:ArrangementFee[1]}' )
			OfferAAFTax3 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:ArrangementFeeTax[1]}' )
			OfferIFD3 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:InternallyFundedDiscount[1]}' )
			OfferTotal3 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:Total[1]}' )

			func_write(payment,"Offer3,Net",product,Offernet3)
			func_write(payment,"Offer3,NetTax",product,OffernetTax3)
			func_write(payment,"Offer3,Commission",product,Offercomm3)
			func_write(payment,"Offer3,CommissionTax",product,OffercommTax3)
			func_write(payment,"Offer3,AAF",product,OfferAAF3)
			func_write(payment,"Offer3,AAFTax",product,OfferAAFTax3)
			func_write(payment,"Offer3,IFD",product,OfferIFD3)
			func_write(payment,"Offer3,Total",product,OfferTotal3)
		}
	}

	def MTAOFFER = context.expand('${686All#MTA Offer}')
	log.info "Offernode -->"  + MTAOFFER
	if (MTAOFFER !="") // if old offer needs to be clawed back
	{
		def MTAOfferNode = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:Code[1]}' )
		if (MTAOfferNode !="")
		{
			Offernet1 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:NetRate[1]}' )
			OffernetTax1 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:NetRateTax[1]}' )
			Offercomm1 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:Commission[1]}' )
			OffercommTax1 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:CommissionTax[1]}' )
			OfferAAF1 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:ArrangementFee[1]}' )
			OfferAAFTax1 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:ArrangementFeeTax[1]}' )
			OfferIFD1 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:InternallyFundedDiscount[1]}' )
			OfferTotal1 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:Total[1]}' )

			func_write(payment,"Offer1,Net",product,Offernet1)
			func_write(payment,"Offer1,NetTax",product,OffernetTax1)
			func_write(payment,"Offer1,Commission",product,Offercomm1)
			func_write(payment,"Offer1,CommissionTax",product,OffercommTax1)
			func_write(payment,"Offer1,AAF",product,OfferAAF1)
			func_write(payment,"Offer1,AAFTax",product,OfferAAFTax1)
			func_write(payment,"Offer1,IFD",product,OfferIFD1)
			func_write(payment,"Offer1,Total",product,OfferTotal1)
		}
	}

	def Renewal_OFFER_TRANS = context.expand('${686All#Renewal Offer}')
	log.info "Offernode -->"  + MTAOFFER
	if (Renewal_OFFER_TRANS !="") // if old offer needs to be clawed back
	{
		def Renewal_OFFER_Node = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+Renewal_OFFER_TRANS+'"]/tns1:Code[1]}' )
		
		
		if (Renewal_OFFER_Node !="")
		{
			Offernet6 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+Renewal_OFFER_TRANS+'"]/tns1:NetRate[1]}' )
			OffernetTax6 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+Renewal_OFFER_TRANS+'"]/tns1:NetRateTax[1]}' )
			Offercomm6 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+Renewal_OFFER_TRANS+'"]/tns1:Commission[1]}' )
			OffercommTax6 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+Renewal_OFFER_TRANS+'"]/tns1:CommissionTax[1]}' )
			OfferAAF6 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+Renewal_OFFER_TRANS+'"]/tns1:ArrangementFee[1]}' )
			OfferAAFTax6 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+Renewal_OFFER_TRANS+'"]/tns1:ArrangementFeeTax[1]}' )
			OfferIFD6 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+Renewal_OFFER_TRANS+'"]/tns1:InternallyFundedDiscount[1]}' )
			OfferTotal6 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+Renewal_OFFER_TRANS+'"]/tns1:Total[1]}' )

			func_write(payment,"Offer6,Net",product,Offernet6)
			func_write(payment,"Offer6,NetTax",product,OffernetTax6)
			func_write(payment,"Offer6,Commission",product,Offercomm6)
			func_write(payment,"Offer6,CommissionTax",product,OffercommTax6)
			func_write(payment,"Offer6,AAF",product,OfferAAF6)
			func_write(payment,"Offer6,AAFTax",product,OfferAAFTax6)
			func_write(payment,"Offer6,IFD",product,OfferIFD6)
			func_write(payment,"Offer6,Total",product,OfferTotal6)
		}
	}

	//Transaction AD validation
	//def AD1 = context.expand( '${686All#MTA AD}' )
	def AD1Node = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:Code[1]}' )
	def AD1net,AD1netTax,AD1comm,AD1commTax,AD1AAF,AD1AAFTax,AD1IFD,AD1Total,AD2net,AD2netTax,AD2comm,AD2commTax,AD2AAF,AD2AAFTax,AD2IFD,AD2Total
	
	if ( AD1Node != "") //if new AD1 exists and AD1 node present
	{
		AD1net = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:NetRate[1]}' )
		AD1netTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:NetRateTax[1]}' )
		AD1comm = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:Commission[1]}' )
		AD1commTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:CommissionTax[1]}' )
		AD1AAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:ArrangementFee[1]}' )
		AD1AAFTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:ArrangementFeeTax[1]}' )
		AD1IFD = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:InternallyFundedDiscount[1]}' )
		AD1Total = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:Total[1]}' )
	
		func_write(payment,"AgentDisc,AD1Net",product,AD1net)
		func_write(payment,"AgentDisc,AD1NetTax",product,AD1netTax)
		func_write(payment,"AgentDisc,AD1Commission",product,AD1comm)
		func_write(payment,"AgentDisc,AD1CommissionTax",product,AD1commTax)
		func_write(payment,"AgentDisc,AD1AAF",product,AD1AAF)
		func_write(payment,"AgentDisc,AD1AAFTax",product,AD1AAFTax)
		func_write(payment,"AgentDisc,AD1IFD",product,AD1IFD)
		func_write(payment,"AgentDisc,AD1Total",product,AD1Total)
	}

	
	def AD2Node =  context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:Code[1]}' )
	if (AD2Node!="")
	{

		AD2net = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:NetRate[1]}' )
		AD2netTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:NetRateTax[1]}' )
		AD2comm = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:Commission[1]}' )
		AD2commTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:CommissionTax[1]}' )
		AD2AAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:ArrangementFee[1]}' )
		AD2AAFTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:ArrangementFeeTax[1]}' )
		AD2IFD = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:InternallyFundedDiscount[1]}' )
		AD2Total = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:Total[1]}' )

			func_write(payment,"AgentDisc,AD2Net",product,AD2net)
			func_write(payment,"AgentDisc,AD2NetTax",product,AD2netTax)
			func_write(payment,"AgentDisc,AD2Commission",product,AD2comm)
			func_write(payment,"AgentDisc,AD2CommissionTax",product,AD2commTax)
			func_write(payment,"AgentDisc,AD2AAF",product,AD2AAF)
			func_write(payment,"AgentDisc,AD2AAFTax",product,AD2AAFTax)
			func_write(payment,"AgentDisc,AD2IFD",product,AD2IFD)
			func_write(payment,"AgentDisc,AD2Total",product,AD2Total)		
	}
	

	def AD3net,AD3netTax,AD3comm,AD3commTax,AD3AAF,AD3AAFTax,AD3IFD,AD3Total
	def AD3Node = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:Code[1]}' )
		if (AD3Node!="")
		{
			AD3net = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:NetRate[1]}' )
			AD3netTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:NetRateTax[1]}' )
			AD3comm = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:Commission[1]}' )
			AD3commTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:CommissionTax[1]}' )
			AD3AAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:ArrangementFee[1]}' )
			AD3AAFTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:ArrangementFeeTax[1]}' )
			AD3IFD = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:InternallyFundedDiscount[1]}' )
			AD3Total = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:Total[1]}' )

			func_write(payment,"AgentDisc,AD3Net",product,AD3net)
			func_write(payment,"AgentDisc,AD3NetTax",product,AD3netTax)
			func_write(payment,"AgentDisc,AD3Commission",product,AD3comm)
			func_write(payment,"AgentDisc,AD3CommissionTax",product,AD3commTax)
			func_write(payment,"AgentDisc,AD3AAF",product,AD3AAF)
			func_write(payment,"AgentDisc,AD3AAFTax",product,AD3AAFTax)
			func_write(payment,"AgentDisc,AD3IFD",product,AD3IFD)
			func_write(payment,"AgentDisc,AD3Total",product,AD3Total)		
		}

		
	func_write(payment,"AccountingTotals,CoreDiscTotal",product,CoreDiscTotal)
	func_write(payment,"AccountingTotals,CoreDiscTaxTotal",product,CoreDiscTaxTotal)
	func_write(payment,"AccountingTotals,CoreCommDiscTotal",product,CoreCommDiscTotal)
	func_write(payment,"AccountingTotals,CoreNetDiscTotal",product,CoreNetDiscTotal)
	func_write(payment,"AccountingTotals,AAFGrandDiscTotal",product,AAFGrandDiscTotal)
	func_write(payment,"AccountingTotals,AAFTaxDiscTotal",product,AAFTaxDiscTotal)
	func_write(payment,"AccountingTotals,AAFDiscTotal",product,AAFDiscTotal)
	func_write(payment,"RelFactor",product,ProdRel)
	func_write(payment,"AAFTotal",product,ProdAAFTotal)
	func_write(payment,"TotalLessAAFTotal",product,ProdTotalLessAAF)
	func_write(payment,"TotalLessDisc",product,ProdTotalLessDisc)
	func_write(payment,"ProductTotal",product,ProdTotal)
	

	def Sysdisc1Node = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOREFUND"]/tns1:Code[1]}' )
	log.info "here" + Sysdisc1Node
	def Sysdisc1net,Sysdisc1netTax,Sysdisc1comm,Sysdisc1commTax,Sysdisc1AAF,Sysdisc1AAFTax,Sysdisc1IFD,Sysdisc1Total
	if (Sysdisc1Node!="")
	{
		//def response = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/						    tns1:Product[1]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[1]/tns1:NetRate[1]}' )
		
		Sysdisc1net = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOREFUND"]/tns1:NetRate[1]}' )
		Sysdisc1netTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOREFUND"]/tns1:NetRateTax[1]}' )
		Sysdisc1comm = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOREFUND"]/tns1:Commission[1]}' )
		Sysdisc1commTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOREFUND"]/tns1:CommissionTax[1]}' )
		Sysdisc1AAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOREFUND"]/tns1:ArrangementFee[1]}' )
		Sysdisc1AAFTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOREFUND"]/tns1:ArrangementFeeTax[1]}' )
		Sysdisc1IFD = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOREFUND"]/tns1:InternallyFundedDiscount[1]}' )
		Sysdisc1Total = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOREFUND"]/tns1:Total[1]}' )
		log.info (Sysdisc1net)
		func_write(payment,"SysDisc,Sysdisc1Net",product,Sysdisc1net)
		func_write(payment,"SysDisc,Sysdisc1NetTax",product,Sysdisc1netTax)
		func_write(payment,"SysDisc,Sysdisc1Commission",product,Sysdisc1comm)
		func_write(payment,"SysDisc,Sysdisc1CommissionTax",product,Sysdisc1commTax)
		func_write(payment,"SysDisc,Sysdisc1AAF",product,Sysdisc1AAF)
		func_write(payment,"SysDisc,Sysdisc1AAFTax",product,Sysdisc1AAFTax)
		func_write(payment,"SysDisc,Sysdisc1IFD",product,Sysdisc1IFD)
		func_write(payment,"SysDisc,Sysdisc1Total",product,Sysdisc1Total)
	}

	def Sysdisc2Node = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:Code[1]}' )
	log.info Sysdisc2Node
	def Sysdisc2net,Sysdisc2netTax,Sysdisc2comm,Sysdisc2commTax,Sysdisc2AAF,Sysdisc2AAFTax,Sysdisc2IFD,Sysdisc2Total
	if (Sysdisc2Node!="")
	{
		Sysdisc2net = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:NetRate[1]}' )
		Sysdisc2netTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:NetRateTax[1]}' )
		Sysdisc2comm = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:Commission[1]}' )
		Sysdisc2commTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:CommissionTax[1]}' )
		Sysdisc2AAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:ArrangementFee[1]}' )
		Sysdisc2AAFTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:ArrangementFeeTax[1]}' )
		Sysdisc2IFD = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:InternallyFundedDiscount[1]}' )
		Sysdisc2Total = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:Total[1]}' )
		func_write(payment,"SysDisc,Sysdisc2Net",product,Sysdisc2net)
		func_write(payment,"SysDisc,Sysdisc2NetTax",product,Sysdisc2netTax)
		func_write(payment,"SysDisc,Sysdisc2Commission",product,Sysdisc2comm)
		func_write(payment,"SysDisc,Sysdisc2CommissionTax",product,Sysdisc2commTax)
		func_write(payment,"SysDisc,Sysdisc2AAF",product,Sysdisc2AAF)
		func_write(payment,"SysDisc,Sysdisc2AAFTax",product,Sysdisc2AAFTax)
		func_write(payment,"SysDisc,Sysdisc2IFD",product,Sysdisc2IFD)
		func_write(payment,"SysDisc,Sysdisc2Total",product,Sysdisc2Total)
		
	}

	def Sysdisc3Node = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:Code[1]}' )
	log.info Sysdisc3Node
	def Sysdisc3net,Sysdisc3netTax,Sysdisc3comm,Sysdisc3commTax,Sysdisc3AAF,Sysdisc3AAFTax,Sysdisc3IFD,Sysdisc3Total
	if (Sysdisc3Node!="")
	{
		Sysdisc3net = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:NetRate[1]}' )
		Sysdisc3netTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:NetRateTax[1]}' )
		Sysdisc3comm = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:Commission[1]}' )
		Sysdisc3commTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:CommissionTax[1]}' )
		Sysdisc3AAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:ArrangementFee[1]}' )
		Sysdisc3AAFTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:ArrangementFeeTax[1]}' )
		Sysdisc3IFD = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:InternallyFundedDiscount[1]}' )
		Sysdisc3Total = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:Price[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:Total[1]}' )
		func_write(payment,"SysDisc,Sysdisc3Net",product,Sysdisc3net)
		func_write(payment,"SysDisc,Sysdisc3NetTax",product,Sysdisc3netTax)
		func_write(payment,"SysDisc,Sysdisc3Commission",product,Sysdisc3comm)
		func_write(payment,"SysDisc,Sysdisc3CommissionTax",product,Sysdisc3commTax)
		func_write(payment,"SysDisc,Sysdisc3AAF",product,Sysdisc3AAF)
		func_write(payment,"SysDisc,Sysdisc3AAFTax",product,Sysdisc3AAFTax)
		func_write(payment,"SysDisc,Sysdisc3IFD",product,Sysdisc3IFD )
		func_write(payment,"SysDisc,Sysdisc3Total",product,Sysdisc3Total)
	}

	 //Policy price
	 log.info "current Product -->"+ product
	 
	def P_CoreNet = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:CorePrice[1]/tns1:NetRate[1]}' )
	def P_CoreNetTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:CorePrice[1]/tns1:NetRateTax[1]}' )
	def P_CoreComm = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:CorePrice[1]/tns1:Commission[1]}' )
	def P_CoreCommTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:CorePrice[1]/tns1:CommissionTax[1]}' )
	def P_TaxTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:CorePrice[1]/tns1:TaxTotal[1]}' )
	def P_CoreTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:CorePrice[1]/tns1:Total[1]}' )
	def P_AAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:ArrangementFee[1]/tns1:Fee[1]}' )
	def P_AAFTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:ArrangementFee[1]/tns1:FeeTax[1]}' )
	def P_AAFTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:ArrangementFee[1]/tns1:Total[1]}' )
	def P_CoreDiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:CoreDiscountsTotal[1]}' )
	def P_CoreDiscTaxTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:CoreDiscountsTaxTotal[1]}' )
	def P_CoreCommDiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:CoreCommissionDiscountsTotal[1]}' )
	def P_CoreNetDiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:CoreNetRateDiscountsTotal[1]}' )
	def P_AAFGrandDiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:ArrangementFeeGrandDiscountsTotal[1]}' )
	def P_AAFTaxDiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:ArrangementFeeTaxDiscountsTotal[1]}' )
	def P_AAFDiscTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AccountingTotals[1]/tns1:ArrangementFeeDiscountsTotal[1]}' )
	def P_ProdRel = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:RelativityPriceFactor[1]}' )
	def P_ProdAAFTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:ArrangementFeeTotal[1]}' )
	def P_ProdTotalLessAAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:TotalLessArrangementFeeTotal[1]}' )
	def P_ProdTotalLessDisc = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:TotalLessDiscounts[1]}' )
	def P_ProdTotal = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:Total[1]}' )
	func_write(payment,"P_CORE,Net",product,P_CoreNet)
	func_write(payment,"P_CORE,NetTax",product,P_CoreNetTax)
	func_write(payment,"P_CORE,Commission",product,P_CoreComm)
	func_write(payment,"P_CORE,CommissionTax",product,P_CoreCommTax)
	func_write(payment,"P_CORE,TaxTotal",product,P_TaxTotal)
	func_write(payment,"P_CORE,Total",product,P_CoreTotal)
	func_write(payment,"P_AAF,AAF",product,P_AAF)
	func_write(payment,"P_AAF,AAFTax",product,P_AAFTax)
	func_write(payment,"P_AAF,Total",product,P_AAFTotal)

	//Policy Offer validation

	
	
	//def OLDOFFER = context.expand('${686All#Persistent Offer}')
	def OfferNode4 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:Code[1]}' )
	
	def Offernet4,OffernetTax4,Offercomm4,OffercommTax4,OfferAAF4,OfferAAFTax4,OfferIFD4,OfferTotal4
	def Offernet5,OffernetTax5,Offercomm5,OffercommTax5,OfferAAF5,OfferAAFTax5,OfferIFD5,OfferTotal5
	if (OfferNode4 != "")//if NB offer exists in policy price
	{
		Offernet4 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:NetRate[1]}' )
		OffernetTax4 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:NetRateTax[1]}' )
		Offercomm4 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:Commission[1]}' )
		OffercommTax4 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:CommissionTax[1]}' )
		OfferAAF4 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:ArrangementFee[1]}' )
		OfferAAFTax4 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:ArrangementFeeTax[1]}' )
		OfferIFD4 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:InternallyFundedDiscount[1]}' )
		OfferTotal4 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+OLDOFFER+'"]/tns1:Total[1]}' )

		func_write(payment,"Offer4,Net",product,Offernet4)
		func_write(payment,"Offer4,NetTax",product,OffernetTax4)
		func_write(payment,"Offer4,Commission",product,Offercomm4)
		func_write(payment,"Offer4,CommissionTax",product,OffercommTax4)
		func_write(payment,"Offer4,AAF",product,OfferAAF4)
		func_write(payment,"Offer4,AAFTax",product,OfferAAFTax4)
		func_write(payment,"Offer4,IFD",product,OfferIFD4)
		func_write(payment,"Offer4,Total",product,OfferTotal4)
	}

	def OfferNode2 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:Code[1]}' )
	if (OfferNode2 != "")//if MTA offer exists in policy price
	{
		Offernet2 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:NetRate[1]}' )
		OffernetTax2 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:NetRateTax[1]}' )
		Offercomm2 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:Commission[1]}' )
		OffercommTax2 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:CommissionTax[1]}' )
		OfferAAF2 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:ArrangementFee[1]}' )
		OfferAAFTax2 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:ArrangementFeeTax[1]}' )
		OfferIFD2 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:InternallyFundedDiscount[1]}' )
		OfferTotal2 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+MTAOFFER+'"]/tns1:Total[1]}' )

		func_write(payment,"Offer2,Net",product,Offernet2)
		func_write(payment,"Offer2,NetTax",product,OffernetTax2)
		func_write(payment,"Offer2,Commission",product,Offercomm2)
		func_write(payment,"Offer2,CommissionTax",product,OffercommTax2)
		func_write(payment,"Offer2,AAF",product,OfferAAF2)
		func_write(payment,"Offer2,AAFTax",product,OfferAAFTax2)
		func_write(payment,"Offer2,IFD",product,OfferIFD2)
		func_write(payment,"Offer2,Total",product,OfferTotal2)
	}
	
	def renewalOffer = context.expand( '${686All#Renewal Offer}' )
	
	log.info renewalOffer

	def OfferNode5 = 	context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+renewalOffer+'"]/tns1:Code[1]}' )
	log.info "RenwalOffer Node "+OfferNode5
	
	if (OfferNode5 != "")//if NB offer exists in policy price
	{
		Offernet5 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+renewalOffer+'"]/tns1:NetRate[1]}' )
		OffernetTax5 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+renewalOffer+'"]/tns1:NetRateTax[1]}' )
		Offercomm5 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+renewalOffer+'"]/tns1:Commission[1]}' )
		OffercommTax5 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+renewalOffer+'"]/tns1:CommissionTax[1]}' )
		OfferAAF5 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+renewalOffer+'"]/tns1:ArrangementFee[1]}' )
		OfferAAFTax5 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+renewalOffer+'"]/tns1:ArrangementFeeTax[1]}' )
		OfferIFD5 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+renewalOffer+'"]/tns1:InternallyFundedDiscount[1]}' )
		OfferTotal5 = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:OfferCodeDiscountList[1]/tns1:OfferCodeDiscount[tns1:Code ="'+renewalOffer+'"]/tns1:Total[1]}' )

		func_write(payment,"Offer5,Net",product,Offernet5)
		func_write(payment,"Offer5,NetTax",product,OffernetTax5)
		func_write(payment,"Offer5,Commission",product,Offercomm5)
		func_write(payment,"Offer5,CommissionTax",product,OffercommTax5)
		func_write(payment,"Offer5,AAF",product,OfferAAF5)
		func_write(payment,"Offer5,AAFTax",product,OfferAAFTax5)
		func_write(payment,"Offer5,IFD",product,OfferIFD5)
		func_write(payment,"Offer5,Total",product,OfferTotal5)
	}
	

	def AD4Node = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:Code[1]}' )
	def AD5Node = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:Code[1]}' )
	def AD6Node = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:Code[1]}' )
	def AD4net,AD4netTax,AD4comm,AD4commTax,AD4AAF,AD4AAFTax,AD4IFD,AD4Total
	def AD5net,AD5netTax,AD5comm,AD5commTax,AD5AAF,AD5AAFTax,AD5IFD,AD5Total
	def AD6net,AD6netTax,AD6comm,AD6commTax,AD6AAF,AD6AAFTax,AD6IFD,AD6Total
	
	if (AD4Node != "") 
	{
		AD4net = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:NetRate[1]}' )
		AD4netTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:NetRateTax[1]}' )
		AD4comm = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:Commission[1]}' )
		AD4commTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:CommissionTax[1]}' )
		AD4AAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:ArrangementFee[1]}' )
		AD4AAFTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:ArrangementFeeTax[1]}' )
		AD4IFD = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:InternallyFundedDiscount[1]}' )
		AD4Total = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[1]/tns1:Total[1]}' )
		

		func_write(payment,"AgentDisc,AD4Net",product,AD4net)
		func_write(payment,"AgentDisc,AD4NetTax",product,AD4netTax)
		func_write(payment,"AgentDisc,AD4Commission",product,AD4comm)
		func_write(payment,"AgentDisc,AD4CommissionTax",product,AD4commTax)
		func_write(payment,"AgentDisc,AD4AAF",product,AD4AAF)
		func_write(payment,"AgentDisc,AD4AAFTax",product,AD4AAFTax)
		func_write(payment,"AgentDisc,AD4IFD",product,AD4IFD )
		func_write(payment,"AgentDisc,AD4Total",product,AD4Total)
		
	}
	if(AD5Node != "") //if new AD1 exists and AD1 node present in policy price and  NB/RNL AD exists
	{
		AD5net = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:NetRate[1]}' )
		AD5netTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:NetRateTax[1]}' )
		AD5comm = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:Commission[1]}' )
		AD5commTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:CommissionTax[1]}' )
		AD5AAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:ArrangementFee[1]}' )
		AD5AAFTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:ArrangementFeeTax[1]}' )
		AD5IFD = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:InternallyFundedDiscount[1]}' )
		AD5Total = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[2]/tns1:Total[1]}' )
		func_write(payment,"AgentDisc,AD5Net",product,AD5net)
		func_write(payment,"AgentDisc,AD5NetTax",product,AD5netTax)
		func_write(payment,"AgentDisc,AD5Commission",product,AD5comm)
		func_write(payment,"AgentDisc,AD5CommissionTax",product,AD5commTax)
		func_write(payment,"AgentDisc,AD5AAF",product,AD5AAF)
		func_write(payment,"AgentDisc,AD5AAFTax",product,AD5AAFTax,)
		func_write(payment,"AgentDisc,AD5IFD",product,AD5IFD, )
		func_write(payment,"AgentDisc,AD5Total",product,AD5Total)
	}

	if (AD6Node!="")
		{
			AD6net = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:NetRate[1]}' )
			AD6netTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:NetRateTax[1]}' )
			AD6comm = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:Commission[1]}' )
			AD6commTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:CommissionTax[1]}' )
			AD6AAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:ArrangementFee[1]}' )
			AD6AAFTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:ArrangementFeeTax[1]}' )
			AD6IFD = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:InternallyFundedDiscount[1]}' )
			AD6Total = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:AgentDiscountList[1]/tns1:AgentDiscount[3]/tns1:Total[1]}' )
			func_write(payment,"AgentDisc,AD6Net",product,AD6net)
			func_write(payment,"AgentDisc,AD6NetTax",product,AD6netTax)
			func_write(payment,"AgentDisc,AD6Commission",product,AD6comm)
			func_write(payment,"AgentDisc,AD6CommissionTax",product,AD6commTax)
			func_write(payment,"AgentDisc,AD6AAF",product,AD6AAF)
			func_write(payment,"AgentDisc,AD6AAFTax",product,AD6AAFTax,)
			func_write(payment,"AgentDisc,AD6IFD",product,AD6IFD, )
			func_write(payment,"AgentDisc,AD6Total",product,AD6Total)	
		}
	
	def Sysdisc4net,Sysdisc4netTax,Sysdisc4comm,Sysdisc4commTax,Sysdisc4AAF,Sysdisc4AAFTax,Sysdisc4IFD,Sysdisc4Total
	if (product == "HomeStart")
	{
		def Sysdisc4Node = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:Code[1]}' )
		if (Sysdisc4Node!="")
		{
			Sysdisc4net = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:NetRate[1]}' )
			Sysdisc4netTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:NetRateTax[1]}' )
			Sysdisc4comm = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:Commission[1]}' )
			Sysdisc4commTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:CommissionTax[1]}' )
			Sysdisc4AAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:ArrangementFee[1]}' )
			Sysdisc4AAFTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:ArrangementFeeTax[1]}' )
			Sysdisc4IFD = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:InternallyFundedDiscount[1]}' )
			Sysdisc4Total = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOTNEG"]/tns1:Total[1]}' )
			func_write(payment,"SysDisc,Sysdisc4Net",product,Sysdisc4net)
			func_write(payment,"SysDisc,Sysdisc4NetTax",product,Sysdisc4netTax)
			func_write(payment,"SysDisc,Sysdisc4Commission",product,Sysdisc4comm)
			func_write(payment,"SysDisc,Sysdisc4CommissionTax",product,Sysdisc4commTax)
			func_write(payment,"SysDisc,Sysdisc4AAF",product,Sysdisc4AAF)
			func_write(payment,"SysDisc,Sysdisc4AAFTax",product,Sysdisc4AAFTax)
			func_write(payment,"SysDisc,Sysdisc4IFD",product,Sysdisc4IFD )
			func_write(payment,"SysDisc,Sysdisc4Total",product,Sysdisc4Total)
		}
	}
	def Sysdisc5net,Sysdisc5netTax,Sysdisc5comm,Sysdisc5commTax,Sysdisc5AAF,Sysdisc5AAFTax,Sysdisc5IFD,Sysdisc5Total
	def Sysdisc5Node = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:Code[1]}' )
		if (Sysdisc5Node!="")
		{
			Sysdisc5net = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:NetRate[1]}' )
			Sysdisc5netTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:NetRateTax[1]}' )
			Sysdisc5comm = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:Commission[1]}' )
			Sysdisc5commTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:CommissionTax[1]}' )
			Sysdisc5AAF = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:ArrangementFee[1]}' )
			Sysdisc5AAFTax = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:ArrangementFeeTax[1]}' )
			Sysdisc5IFD = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:InternallyFundedDiscount[1]}' )
			Sysdisc5Total = context.expand( '${686Request#Response#declare namespace tns3=\'http://www.theaa.com/CommonServices/Message/BS/Road/GenerateQuote_MTA.3\'; declare namespace tns1=\'http://www.theaa.com/CommonServices/Data/Product.2\'; //tns3:GenerateQuoteResponse[1]/tns3:ProductList[1]/tns1:Payment[1]/tns1:Product[tns1:ProductPriceName ="'+product+'"]/tns1:PriceList[1]/tns1:PolicyPrice[1]/tns1:PriceBreakdown[1]/tns1:SystemDiscountList[1]/tns1:SystemDiscount[tns1:Code ="NOCHARGE"]/tns1:Total[1]}' )
			func_write(payment,"SysDisc,Sysdisc5Net",product,Sysdisc5net)
			func_write(payment,"SysDisc,Sysdisc5NetTax",product,Sysdisc5netTax)
			func_write(payment,"SysDisc,Sysdisc5Commission",product,Sysdisc5comm)
			func_write(payment,"SysDisc,Sysdisc5CommissionTax",product,Sysdisc5commTax)
			func_write(payment,"SysDisc,Sysdisc5AAF",product,Sysdisc5AAF)
			func_write(payment,"SysDisc,Sysdisc5AAFTax",product,Sysdisc5AAFTax)
			func_write(payment,"SysDisc,Sysdisc5IFD",product,Sysdisc5IFD )
			func_write(payment,"SysDisc,Sysdisc5Total",product,Sysdisc5Total)
		}
	func_write(payment,"P_CoreDiscTotal",product,P_CoreDiscTotal)
	func_write(payment,"P_CoreDiscTaxTotal",product,P_CoreDiscTaxTotal)
	func_write(payment,"P_CoreCommDiscTotal",product,P_CoreCommDiscTotal)
	func_write(payment,"P_CoreNetDiscTotal",product,P_CoreNetDiscTotal)
	func_write(payment,"P_AAFGrandDiscTotal",product,P_AAFGrandDiscTotal)
	func_write(payment,"P_AAFTaxDiscTotal",product,P_AAFTaxDiscTotal)
	func_write(payment,"P_AAFDiscTotal",product,P_AAFDiscTotal)
	func_write(payment,"P_RelFactor",product,P_ProdRel)
	func_write(payment,"P_AAFTotal",product,P_ProdAAFTotal)
	func_write(payment,"P_TotalLessAAFTotal",product,P_ProdTotalLessAAF)
	func_write(payment,"P_TotalLessDisc",product,P_ProdTotalLessDisc)
	func_write(payment,"P_ProductTotal",product,P_ProdTotal)


	
	
}




def func_write (payment,element,name,RadarValue)
{
	int totalOfValuesChecked = Integer.parseInt(context.expand( '${#TestCase#TotalOfValuesChecked}' ))
	def prodType = context.expand( '${686All#NewProduct}' )

	if (context.expand('${686All#NewBRC}') == "Y")
	{
		Car1 = context.expand( '${686All#NewCar1}' )
		Car2 = context.expand( '${686All#NewCar2}' )
		Car3 = context.expand( '${686All#NewCar3}' )
		Car4 = context.expand( '${686All#NewCar4}' )
		if (Car4 != "")
		{
			product_type = prodType + "(" + "Car1:" + Car1 + ",Car2:" + Car2 + ",Car3:" + Car3 + ",Car4:" + Car4 + ")"
		}
		else if (Car3 != "")
		{
			product_type = prodType + "(" + "Car1:" + Car1 + ",Car2:" + Car2 + ",Car3:" + Car3 + ")"
		}
		else if (Car2 != "")
		{
			product_type = prodType + "("  + "Car1:" + Car1 + ",Car2:" + Car2 + ")"
		}
		else
		{
			product_type = prodType + "(" + "Car1:" + Car1 + ")"
		}
	}
	else
	{
		product_type = context.expand( '${686All#NEWPRODUCT}' )
	}

	if (name == "BasicBreakdown" || name == "LocalDriver" ||  name == "ROCO" || name ==  "ROPOV" || name == "Standby" ||  name == "StartUp" )
	{
		 name= "Roadside"
	}
	log.info Pass=(context.expand('${686All#ID}') + "|" + context.expand( '${686All#NB/RNL Offer}' ) + "|"  + payment + "|" + product_type + "|" + context.expand( '${686All#NewCover_type}' ) + "|" + name + "|" + element + "| " + RadarValue )

	
	
	BufferedWriter bw = new BufferedWriter (new FileWriter (context.expand('${#TestCase#ResultFile}'), true));
	bw.write (Pass);
	bw.newLine();
	bw.flush();
	bw.close();
	totalOfValuesChecked++
	testRunner.testCase.setPropertyValue( 'totalOfValuesChecked',  new Integer(totalOfValuesChecked).toString())
	
}</script>
    </con:config>
  </con:testStep>
  <con:testStep type="datasourceloop" name="DataSource Loop" id="23f0c770-0cd7-46a8-967f-75f1d206c928">
    <con:settings/>
    <con:config>
      <dataSourceStep>686All</dataSourceStep>
      <targetStep>Setup_686_ProductList_XML</targetStep>
      <discardResults>false</discardResults>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Log Results" id="b2ddda50-8b22-489d-b331-be2919f1a28e">
    <con:settings/>
    <con:config>
      <script>log.info("    ********************************")
log.info("    ************RESULTS*************")
log.info("    Number of Iterations: " + context.expand( '${#TestCase#NumOfIterations}' ))
log.info("    Number of Values Checked: " + context.expand( '${#TestCase#TotalOfValuesChecked}' ))
//log.info("    Number of Failed values: " + context.expand( '${#TestCase#NumOfValuesFailed}' ))
log.info("    Request Date Time: " + context.expand( '${#TestCase#RequestDateTime}' ))
log.info("    ********************************")
log.info("    ********************************")

NumberofIterations = ("    Number of Iterations: " + context.expand( '${#TestCase#NumOfIterations}'));
NumberofValuesChecked = ("    Number of Values Checked: " + context.expand( '${#TestCase#TotalOfValuesChecked}' ));
//NumberofFailedValues = ("    Number of Failed values: " + context.expand( '${#TestCase#NumOfValuesFailed}' ));
RequestDateTime = ("    RequestDateTime: " + context.expand( '${#TestCase#RequestDateTime}' ));

BufferedWriter bw = new BufferedWriter (new FileWriter (context.expand('${#TestCase#File}'), true));
bw.write (NumberofIterations);
bw.newLine();
bw.write (NumberofValuesChecked);
bw.newLine();
//bw.write (NumberofFailedValues);
//bw.newLine();
bw.write (RequestDateTime);
bw.newLine();
bw.flush();
bw.close();</script>
    </con:config>
  </con:testStep>
  <con:properties>
    <con:property>
      <con:name>ProductList_XML</con:name>
      <con:value><![CDATA[<gen:Product><prod:ProductCode>PRD_UK_0002</prod:ProductCode></gen:Product><gen:Product><prod:ProductCode>PRD_UK_0005</prod:ProductCode></gen:Product><gen:Product><prod:ProductCode>PRD_UK_0018</prod:ProductCode></gen:Product><gen:VehicleAgeList></gen:VehicleAgeList>]]></con:value>
    </con:property>
    <con:property>
      <con:name>RoadList</con:name>
      <con:value>PRD_UK_0001</con:value>
    </con:property>
    <con:property>
      <con:name>RoadNameList</con:name>
      <con:value>Roadside</con:value>
    </con:property>
    <con:property>
      <con:name>TaxType</con:name>
      <con:value>I</con:value>
    </con:property>
    <con:property>
      <con:name>Cover</con:name>
      <con:value>0</con:value>
    </con:property>
    <con:property>
      <con:name>BRCList_XML</con:name>
      <con:value/>
    </con:property>
    <con:property>
      <con:name>FeeList_XML</con:name>
      <con:value/>
    </con:property>
    <con:property>
      <con:name>Threshold_XML</con:name>
      <con:value/>
    </con:property>
    <con:property>
      <con:name>AgentDiscount_XML</con:name>
      <con:value/>
    </con:property>
    <con:property>
      <con:name>AgentDiscountsApplied</con:name>
      <con:value>null</con:value>
    </con:property>
    <con:property>
      <con:name>MTA1_New_ProductList_XML</con:name>
      <con:value><![CDATA[<gen:Product><prod:ProductCode>PRD_UK_0012</prod:ProductCode></gen:Product><gen:Product><prod:ProductCode>PRD_UK_0005</prod:ProductCode></gen:Product>]]></con:value>
    </con:property>
    <con:property>
      <con:name>MTA1NEWCover</con:name>
      <con:value>0</con:value>
    </con:property>
    <con:property>
      <con:name>MTAFeeList_XML</con:name>
      <con:value/>
    </con:property>
    <con:property>
      <con:name>RiskCommunityInd</con:name>
      <con:value>Community</con:value>
    </con:property>
    <con:property>
      <con:name>Transaction</con:name>
      <con:value>Renewal</con:value>
    </con:property>
    <con:property>
      <con:name>MTAAgentDiscount_XML</con:name>
      <con:value/>
    </con:property>
    <con:property>
      <con:name>RNL_Trans_MTA1_CurrentPolicyPrice_XML</con:name>
      <con:value><![CDATA[<gen:Product><prod:ProductCode>PRD_UK_0002</prod:ProductCode><prod:ProductPriceName>Roadside</prod:ProductPriceName><gen:PriceList><prod:PolicyPrice><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice><prod:NetRate></prod:NetRate><prod:NetRateTax></prod:NetRateTax><prod:Commission></prod:Commission><prod:CommissionTax></prod:CommissionTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:TaxTotal></prod:TaxTotal><prod:Total></prod:Total></prod:CorePrice><prod:ArrangementFee><prod:Fee></prod:Fee><prod:FeeTax></prod:FeeTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:Total></prod:Total></prod:ArrangementFee><prod:AccountingTotals><prod:CoreDiscountsTotal></prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal></prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal></prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal></prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal></prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal></prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal></prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown><prod:TaxType></prod:TaxType><prod:TaxDate></prod:TaxDate><prod:DateInceptedOnPolicy></prod:DateInceptedOnPolicy><prod:RelativityPriceFactor></prod:RelativityPriceFactor><prod:ExtrapolationFactor></prod:ExtrapolationFactor><prod:ArrangementFeeTotal></prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal></prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts></prod:TotalLessDiscounts><prod:Total></prod:Total></prod:PolicyPrice></gen:PriceList><prod:InsideCoolingOffFlag>false</prod:InsideCoolingOffFlag><prod:FullRefundFlag>false</prod:FullRefundFlag><prod:PaidPeriods>1</prod:PaidPeriods></gen:Product><gen:Product><prod:ProductCode>PRD_UK_0005</prod:ProductCode><prod:ProductPriceName>StayMobile</prod:ProductPriceName><gen:PriceList><prod:PolicyPrice><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice><prod:NetRate></prod:NetRate><prod:NetRateTax></prod:NetRateTax><prod:Commission></prod:Commission><prod:CommissionTax></prod:CommissionTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:TaxTotal></prod:TaxTotal><prod:Total></prod:Total></prod:CorePrice><prod:ArrangementFee><prod:Fee></prod:Fee><prod:FeeTax></prod:FeeTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:Total></prod:Total></prod:ArrangementFee><prod:AccountingTotals><prod:CoreDiscountsTotal></prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal></prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal></prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal></prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal></prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal></prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal></prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown><prod:TaxType></prod:TaxType><prod:TaxDate></prod:TaxDate><prod:DateInceptedOnPolicy></prod:DateInceptedOnPolicy><prod:RelativityPriceFactor></prod:RelativityPriceFactor><prod:ExtrapolationFactor></prod:ExtrapolationFactor><prod:ArrangementFeeTotal></prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal></prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts></prod:TotalLessDiscounts><prod:Total></prod:Total></prod:PolicyPrice></gen:PriceList><prod:InsideCoolingOffFlag>false</prod:InsideCoolingOffFlag><prod:FullRefundFlag>false</prod:FullRefundFlag><prod:PaidPeriods>1</prod:PaidPeriods></gen:Product><gen:Product><prod:ProductCode>PRD_UK_0018</prod:ProductCode><prod:ProductPriceName>BRC</prod:ProductPriceName><gen:PriceList><prod:PolicyPrice><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice><prod:NetRate></prod:NetRate><prod:NetRateTax></prod:NetRateTax><prod:Commission></prod:Commission><prod:CommissionTax></prod:CommissionTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:TaxTotal></prod:TaxTotal><prod:Total></prod:Total></prod:CorePrice><prod:ArrangementFee><prod:Fee></prod:Fee><prod:FeeTax></prod:FeeTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:Total></prod:Total></prod:ArrangementFee><prod:AccountingTotals><prod:CoreDiscountsTotal></prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal></prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal></prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal></prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal></prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal></prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal></prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown><prod:TaxType></prod:TaxType><prod:TaxDate></prod:TaxDate><prod:DateInceptedOnPolicy></prod:DateInceptedOnPolicy><prod:RelativityPriceFactor></prod:RelativityPriceFactor><prod:ExtrapolationFactor></prod:ExtrapolationFactor><prod:ArrangementFeeTotal></prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal></prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts></prod:TotalLessDiscounts><prod:Total></prod:Total></prod:PolicyPrice></gen:PriceList><prod:InsideCoolingOffFlag>false</prod:InsideCoolingOffFlag><prod:FullRefundFlag>false</prod:FullRefundFlag><prod:PaidPeriods>1</prod:PaidPeriods></gen:Product><prod:VehicleAgeList><prod:VehicleAge>7</prod:VehicleAge><prod:VehicleAge>8</prod:VehicleAge></prod:VehicleAgeList>]]></con:value>
    </con:property>
    <con:property>
      <con:name>RNL_Trans_MTA1_TransPrice_XML</con:name>
      <con:value><![CDATA[<gen:TransactionProduct><prod:ProductCode>PRD_UK_0002</prod:ProductCode><prod:ProductPriceName>Roadside</prod:ProductPriceName><gen:TransactionPriceList><prod:Price><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice><prod:NetRate></prod:NetRate><prod:NetRateTax></prod:NetRateTax><prod:Commission></prod:Commission><prod:CommissionTax></prod:CommissionTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:TaxTotal></prod:TaxTotal><prod:Total></prod:Total></prod:CorePrice><prod:ArrangementFee><prod:Fee></prod:Fee><prod:FeeTax></prod:FeeTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:Total></prod:Total></prod:ArrangementFee><prod:AccountingTotals><prod:CoreDiscountsTotal></prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal></prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal></prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal></prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal></prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal></prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal></prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown><prod:TaxType></prod:TaxType><prod:TaxDate></prod:TaxDate><prod:DateInceptedOnPolicy></prod:DateInceptedOnPolicy><prod:RelativityPriceFactor></prod:RelativityPriceFactor><prod:ExtrapolationFactor></prod:ExtrapolationFactor><prod:ArrangementFeeTotal></prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal></prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts></prod:TotalLessDiscounts><prod:Total></prod:Total></prod:Price></gen:TransactionPriceList></gen:TransactionProduct><gen:TransactionProduct><prod:ProductCode>PRD_UK_0005</prod:ProductCode><prod:ProductPriceName>StayMobile</prod:ProductPriceName><gen:TransactionPriceList><prod:Price><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice><prod:NetRate></prod:NetRate><prod:NetRateTax></prod:NetRateTax><prod:Commission></prod:Commission><prod:CommissionTax></prod:CommissionTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:TaxTotal></prod:TaxTotal><prod:Total></prod:Total></prod:CorePrice><prod:ArrangementFee><prod:Fee></prod:Fee><prod:FeeTax></prod:FeeTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:Total></prod:Total></prod:ArrangementFee><prod:AccountingTotals><prod:CoreDiscountsTotal></prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal></prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal></prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal></prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal></prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal></prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal></prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown><prod:TaxType></prod:TaxType><prod:TaxDate></prod:TaxDate><prod:DateInceptedOnPolicy></prod:DateInceptedOnPolicy><prod:RelativityPriceFactor></prod:RelativityPriceFactor><prod:ExtrapolationFactor></prod:ExtrapolationFactor><prod:ArrangementFeeTotal></prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal></prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts></prod:TotalLessDiscounts><prod:Total></prod:Total></prod:Price></gen:TransactionPriceList></gen:TransactionProduct><gen:TransactionProduct><prod:ProductCode>PRD_UK_0018</prod:ProductCode><prod:ProductPriceName>BRC</prod:ProductPriceName><gen:TransactionPriceList><prod:Price><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice><prod:NetRate></prod:NetRate><prod:NetRateTax></prod:NetRateTax><prod:Commission></prod:Commission><prod:CommissionTax></prod:CommissionTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:TaxTotal></prod:TaxTotal><prod:Total></prod:Total></prod:CorePrice><prod:ArrangementFee><prod:Fee></prod:Fee><prod:FeeTax></prod:FeeTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:Total></prod:Total></prod:ArrangementFee><prod:AccountingTotals><prod:CoreDiscountsTotal></prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal></prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal></prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal></prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal></prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal></prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal></prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown><prod:TaxType></prod:TaxType><prod:TaxDate></prod:TaxDate><prod:DateInceptedOnPolicy></prod:DateInceptedOnPolicy><prod:RelativityPriceFactor></prod:RelativityPriceFactor><prod:ExtrapolationFactor></prod:ExtrapolationFactor><prod:ArrangementFeeTotal></prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal></prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts></prod:TotalLessDiscounts><prod:Total></prod:Total></prod:Price></gen:TransactionPriceList><prod:VehicleAgeList><prod:VehicleAge>7</prod:VehicleAge><prod:VehicleAge>8</prod:VehicleAge></prod:VehicleAgeList></gen:TransactionProduct>]]></con:value>
    </con:property>
    <con:property>
      <con:name>TotalOfValuesChecked</con:name>
      <con:value>26086</con:value>
    </con:property>
    <con:property>
      <con:name>NumOfIterations</con:name>
      <con:value>91</con:value>
    </con:property>
    <con:property>
      <con:name>RequestDateTime</con:name>
      <con:value>2020-02-08T00:00:00</con:value>
    </con:property>
    <con:property>
      <con:name>PolicyStartDateTime</con:name>
      <con:value>2019-03-17T00:00:00</con:value>
    </con:property>
    <con:property>
      <con:name>PolicyEndDateTime</con:name>
      <con:value>2020-03-16T00:00:00</con:value>
    </con:property>
    <con:property>
      <con:name>TaxDateTime</con:name>
      <con:value>2019-04-17T00:00:00</con:value>
    </con:property>
    <con:property>
      <con:name>PriceDate</con:name>
      <con:value>2019-04-17T00:00:00</con:value>
    </con:property>
    <con:property>
      <con:name>FeesDate</con:name>
      <con:value>2019-04-17T00:00:00</con:value>
    </con:property>
    <con:property>
      <con:name>File</con:name>
      <con:value>N:/Systems_development/RIO/Road Renewals/Soap UI/Test Results/408RNLTransE2EResults-MTA20190515T160230.txt</con:value>
    </con:property>
    <con:property>
      <con:name>ProductTotalResultFile</con:name>
      <con:value>N:/Systems_development/RIO/Road MTA-CR-242/Soap UI/Test Results/408NBR/ProductTotalNBRresults20190529T124153.txt</con:value>
    </con:property>
    <con:property>
      <con:name>PolicyTotalResultFile</con:name>
      <con:value>N:/Systems_development/RIO/Road MTA-CR-242/Soap UI/Test Results/408NBR/PolicyTotalNBRresults20190529T124153.txt</con:value>
    </con:property>
    <con:property>
      <con:name>DiscTotalResultFile</con:name>
      <con:value>N:/Systems_development/RIO/Road MTA-CR-242/Soap UI/Test Results/408NBR/DiscTotalNBRresults20190529T124153.txt</con:value>
    </con:property>
    <con:property>
      <con:name>payment</con:name>
      <con:value>CMM</con:value>
    </con:property>
    <con:property>
      <con:name>ResultFile</con:name>
      <con:value>N:/Systems_development/RIO/Road MTA-CR-242/Soap UI/Test Results/RCR-686/Results20200302T152359.txt</con:value>
    </con:property>
    <con:property>
      <con:name>Reprice</con:name>
      <con:value><![CDATA[<gen:RepriceDetails><gen:RepriceAction>MaintainOriginalPrice</gen:RepriceAction><gen:OriginalPrice>100</gen:OriginalPrice><prod:RelatedAdjustmentCode>DR2YPC17</prod:RelatedAdjustmentCode></gen:RepriceDetails>]]></con:value>
    </con:property>
    <con:property>
      <con:name>RenewalPrice</con:name>
      <con:value><![CDATA[<gen:Product><prod:ProductCode>PRD_UK_0005</prod:ProductCode><prod:ProductPriceName>StayMobile</prod:ProductPriceName><gen:PriceList><prod:PolicyPrice><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice><prod:NetRate>0.0</prod:NetRate><prod:NetRateTax>0.0</prod:NetRateTax><prod:Commission>56.45</prod:Commission><prod:CommissionTax>6.77</prod:CommissionTax><prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount><prod:TaxPercentage>0.12</prod:TaxPercentage><prod:TaxTotal>6.77</prod:TaxTotal><prod:Total>63.22</prod:Total></prod:CorePrice><prod:ArrangementFee><prod:Fee>9.96</prod:Fee><prod:FeeTax>0.0</prod:FeeTax><prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount><prod:TaxPercentage>0.12</prod:TaxPercentage><prod:Total>9.96</prod:Total></prod:ArrangementFee><prod:AccountingTotals><prod:CoreDiscountsTotal>0.0</prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal>0.0</prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal>0.0</prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal>0.0</prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal>0.0</prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal>0.0</prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal>0.0</prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown><prod:TaxType>I</prod:TaxType><prod:TaxDate>2020-02-01T00:00:00</prod:TaxDate><prod:DateInceptedOnPolicy>2020-02-01T00:00:00</prod:DateInceptedOnPolicy><prod:RelativityPriceFactor>1.0</prod:RelativityPriceFactor><prod:ExtrapolationFactor>1.0</prod:ExtrapolationFactor><prod:ArrangementFeeTotal>9.96</prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal>48.57</prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts>58.53</prod:TotalLessDiscounts><prod:Total>58.53</prod:Total></prod:PolicyPrice></gen:PriceList></gen:Product><gen:Product><prod:ProductCode>PRD_UK_0018</prod:ProductCode><prod:ProductPriceName>BRC</prod:ProductPriceName><gen:PriceList><prod:PolicyPrice><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice><prod:NetRate>0.0</prod:NetRate><prod:NetRateTax>0.0</prod:NetRateTax><prod:Commission>56.45</prod:Commission><prod:CommissionTax>6.77</prod:CommissionTax><prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount><prod:TaxPercentage>0.12</prod:TaxPercentage><prod:TaxTotal>6.77</prod:TaxTotal><prod:Total>63.22</prod:Total></prod:CorePrice><prod:ArrangementFee><prod:Fee>9.96</prod:Fee><prod:FeeTax>0.0</prod:FeeTax><prod:InternallyFundedDiscount>0.0</prod:InternallyFundedDiscount><prod:TaxPercentage>0.12</prod:TaxPercentage><prod:Total>9.96</prod:Total></prod:ArrangementFee><prod:AccountingTotals><prod:CoreDiscountsTotal>0.0</prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal>0.0</prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal>0.0</prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal>0.0</prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal>0.0</prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal>0.0</prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal>0.0</prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown><prod:TaxType>I</prod:TaxType><prod:TaxDate>2020-02-01T00:00:00</prod:TaxDate><prod:DateInceptedOnPolicy>2020-02-01T00:00:00</prod:DateInceptedOnPolicy><prod:RelativityPriceFactor>1.0</prod:RelativityPriceFactor><prod:ExtrapolationFactor>1.0</prod:ExtrapolationFactor><prod:ArrangementFeeTotal>9.96</prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal>48.57</prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts>58.53</prod:TotalLessDiscounts><prod:Total>58.53</prod:Total></prod:PolicyPrice></gen:PriceList></gen:Product>]]></con:value>
    </con:property>
    <con:property>
      <con:name>RenewalFile</con:name>
      <con:value>N:/Systems_development/RIO/Road MTA-CR-242/Soap UI/Test Results/RCR-686/Renewal20200302T152359.txt</con:value>
    </con:property>
    <con:property>
      <con:name>Setindicator</con:name>
      <con:value/>
    </con:property>
    <con:property>
      <con:name>RNL_YR2_CurrentPolicyPrice_XML</con:name>
      <con:value><![CDATA[<gen:Product><prod:ProductCode>PRD_UK_0002</prod:ProductCode><prod:ProductPriceName>Roadside</prod:ProductPriceName><gen:PriceList><prod:PolicyPrice><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice><prod:NetRate></prod:NetRate><prod:NetRateTax></prod:NetRateTax><prod:Commission></prod:Commission><prod:CommissionTax></prod:CommissionTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:TaxTotal></prod:TaxTotal><prod:Total></prod:Total></prod:CorePrice><prod:ArrangementFee><prod:Fee></prod:Fee><prod:FeeTax></prod:FeeTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:Total></prod:Total></prod:ArrangementFee><prod:AccountingTotals><prod:CoreDiscountsTotal></prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal></prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal></prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal></prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal></prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal></prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal></prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown><prod:TaxType></prod:TaxType><prod:TaxDate></prod:TaxDate><prod:DateInceptedOnPolicy></prod:DateInceptedOnPolicy><prod:RelativityPriceFactor></prod:RelativityPriceFactor><prod:ExtrapolationFactor></prod:ExtrapolationFactor><prod:ArrangementFeeTotal></prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal></prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts></prod:TotalLessDiscounts><prod:Total></prod:Total></prod:PolicyPrice></gen:PriceList></gen:Product><gen:Product><prod:ProductCode>PRD_UK_0005</prod:ProductCode><prod:ProductPriceName>StayMobile</prod:ProductPriceName><gen:PriceList><prod:PolicyPrice><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice><prod:NetRate></prod:NetRate><prod:NetRateTax></prod:NetRateTax><prod:Commission></prod:Commission><prod:CommissionTax></prod:CommissionTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:TaxTotal></prod:TaxTotal><prod:Total></prod:Total></prod:CorePrice><prod:ArrangementFee><prod:Fee></prod:Fee><prod:FeeTax></prod:FeeTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:Total></prod:Total></prod:ArrangementFee><prod:AccountingTotals><prod:CoreDiscountsTotal></prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal></prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal></prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal></prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal></prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal></prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal></prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown><prod:TaxType></prod:TaxType><prod:TaxDate></prod:TaxDate><prod:DateInceptedOnPolicy></prod:DateInceptedOnPolicy><prod:RelativityPriceFactor></prod:RelativityPriceFactor><prod:ExtrapolationFactor></prod:ExtrapolationFactor><prod:ArrangementFeeTotal></prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal></prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts></prod:TotalLessDiscounts><prod:Total></prod:Total></prod:PolicyPrice></gen:PriceList></gen:Product><gen:Product><prod:ProductCode>PRD_UK_0018</prod:ProductCode><prod:ProductPriceName>BRC</prod:ProductPriceName><gen:PriceList><prod:PolicyPrice><prod:PriceElementType/><prod:PriceBreakdown><prod:CorePrice><prod:NetRate></prod:NetRate><prod:NetRateTax></prod:NetRateTax><prod:Commission></prod:Commission><prod:CommissionTax></prod:CommissionTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:TaxTotal></prod:TaxTotal><prod:Total></prod:Total></prod:CorePrice><prod:ArrangementFee><prod:Fee></prod:Fee><prod:FeeTax></prod:FeeTax><prod:InternallyFundedDiscount></prod:InternallyFundedDiscount><prod:TaxPercentage></prod:TaxPercentage><prod:Total></prod:Total></prod:ArrangementFee><prod:AccountingTotals><prod:CoreDiscountsTotal></prod:CoreDiscountsTotal><prod:CoreDiscountsTaxTotal></prod:CoreDiscountsTaxTotal><prod:CoreCommissionDiscountsTotal></prod:CoreCommissionDiscountsTotal><prod:CoreNetRateDiscountsTotal></prod:CoreNetRateDiscountsTotal><prod:ArrangementFeeGrandDiscountsTotal></prod:ArrangementFeeGrandDiscountsTotal><prod:ArrangementFeeTaxDiscountsTotal></prod:ArrangementFeeTaxDiscountsTotal><prod:ArrangementFeeDiscountsTotal></prod:ArrangementFeeDiscountsTotal></prod:AccountingTotals></prod:PriceBreakdown><prod:TaxType></prod:TaxType><prod:TaxDate></prod:TaxDate><prod:DateInceptedOnPolicy></prod:DateInceptedOnPolicy><prod:RelativityPriceFactor></prod:RelativityPriceFactor><prod:ExtrapolationFactor></prod:ExtrapolationFactor><prod:ArrangementFeeTotal></prod:ArrangementFeeTotal><prod:TotalLessArrangementFeeTotal></prod:TotalLessArrangementFeeTotal><prod:TotalLessDiscounts></prod:TotalLessDiscounts><prod:Total></prod:Total></prod:PolicyPrice></gen:PriceList></gen:Product><prod:VehicleAgeList></prod:VehicleAgeList>]]></con:value>
    </con:property>
  </con:properties>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>69cf8be6-1020-406e-8767-7dae173a9244</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>58d4d2f7-ecf9-4f2a-a4c6-765bb1501fac</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>109ef6a5-a9cb-45c6-8bf1-697b0cfcdcc2</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>f641bd6c-e8f4-4bde-a591-4740f0eb2ae0</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>e5e597af-1b93-4325-b8b5-445158abcdd8</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>cbc813e3-c325-4078-a248-80deae0e4011</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>b983778c-ff91-4200-a8c0-d08bb3c62e19</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>7f0dfa33-f817-4c34-9c3e-10af7ebd630f</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>42e8000c-143e-4356-9f11-841057ccf87b</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>37515d76-5c05-479a-b7bb-c20f233d88bb</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>a66b7d8d-8365-46b4-8173-d4fcec912f4a</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>3e716af4-0646-42bf-b09b-f20cb3efef31</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>678218b2-4512-40a7-a2d7-5d0b1701f1d3</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
</con:testCase>
